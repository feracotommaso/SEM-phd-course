<!DOCTYPE html>
<html lang="en"><head>
<script src="../site_libs/clipboard/clipboard.min.js"></script>
<script src="../site_libs/quarto-html/tabby.min.js"></script>
<script src="../site_libs/quarto-html/popper.min.js"></script>
<script src="../site_libs/quarto-html/tippy.umd.min.js"></script>
<link href="../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../site_libs/quarto-html/light-border.css" rel="stylesheet">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting-37eea08aefeeee20ff55810ff984fec1.css" rel="stylesheet" id="quarto-text-highlighting-styles"><meta charset="utf-8">
  <meta name="generator" content="quarto-1.7.32">

  <meta name="author" content="Tommaso Feraco">
  <title>SEM-PhD – Longitudinal SEM: Growth + Invariance Over Time</title>
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, minimal-ui">
  <link rel="stylesheet" href="../site_libs/revealjs/dist/reset.css">
  <link rel="stylesheet" href="../site_libs/revealjs/dist/reveal.css">
  <style>
    code{white-space: pre-wrap;}
    span.smallcaps{font-variant: small-caps;}
    div.columns{display: flex; gap: min(4vw, 1.5em);}
    div.column{flex: auto; overflow-x: auto;}
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
    ul.task-list{list-style: none;}
    ul.task-list li input[type="checkbox"] {
      width: 0.8em;
      margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
      vertical-align: middle;
    }
    /* CSS for syntax highlighting */
    html { -webkit-text-size-adjust: 100%; }
    pre > code.sourceCode { white-space: pre; position: relative; }
    pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
    pre > code.sourceCode > span:empty { height: 1.2em; }
    .sourceCode { overflow: visible; }
    code.sourceCode > span { color: inherit; text-decoration: inherit; }
    div.sourceCode { margin: 1em 0; }
    pre.sourceCode { margin: 0; }
    @media screen {
    div.sourceCode { overflow: auto; }
    }
    @media print {
    pre > code.sourceCode { white-space: pre-wrap; }
    pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
    }
    pre.numberSource code
      { counter-reset: source-line 0; }
    pre.numberSource code > span
      { position: relative; left: -4em; counter-increment: source-line; }
    pre.numberSource code > span > a:first-child::before
      { content: counter(source-line);
        position: relative; left: -1em; text-align: right; vertical-align: baseline;
        border: none; display: inline-block;
        -webkit-touch-callout: none; -webkit-user-select: none;
        -khtml-user-select: none; -moz-user-select: none;
        -ms-user-select: none; user-select: none;
        padding: 0 4px; width: 4em;
        color: #aaaaaa;
      }
    pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
    div.sourceCode
      { color: #003b4f; background-color: #f1f3f5; }
    @media screen {
    pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
    }
    code span { color: #003b4f; } /* Normal */
    code span.al { color: #ad0000; } /* Alert */
    code span.an { color: #5e5e5e; } /* Annotation */
    code span.at { color: #657422; } /* Attribute */
    code span.bn { color: #ad0000; } /* BaseN */
    code span.bu { } /* BuiltIn */
    code span.cf { color: #003b4f; font-weight: bold; } /* ControlFlow */
    code span.ch { color: #20794d; } /* Char */
    code span.cn { color: #8f5902; } /* Constant */
    code span.co { color: #5e5e5e; } /* Comment */
    code span.cv { color: #5e5e5e; font-style: italic; } /* CommentVar */
    code span.do { color: #5e5e5e; font-style: italic; } /* Documentation */
    code span.dt { color: #ad0000; } /* DataType */
    code span.dv { color: #ad0000; } /* DecVal */
    code span.er { color: #ad0000; } /* Error */
    code span.ex { } /* Extension */
    code span.fl { color: #ad0000; } /* Float */
    code span.fu { color: #4758ab; } /* Function */
    code span.im { color: #00769e; } /* Import */
    code span.in { color: #5e5e5e; } /* Information */
    code span.kw { color: #003b4f; font-weight: bold; } /* Keyword */
    code span.op { color: #5e5e5e; } /* Operator */
    code span.ot { color: #003b4f; } /* Other */
    code span.pp { color: #ad0000; } /* Preprocessor */
    code span.sc { color: #5e5e5e; } /* SpecialChar */
    code span.ss { color: #20794d; } /* SpecialString */
    code span.st { color: #20794d; } /* String */
    code span.va { color: #111111; } /* Variable */
    code span.vs { color: #20794d; } /* VerbatimString */
    code span.wa { color: #5e5e5e; font-style: italic; } /* Warning */
  </style>
  <link rel="stylesheet" href="../site_libs/revealjs/dist/theme/quarto-a589dfdd18e65617bd4e8915e98a7fff.css">
  <link href="../site_libs/revealjs/plugin/quarto-line-highlight/line-highlight.css" rel="stylesheet">
  <link href="../site_libs/revealjs/plugin/reveal-menu/menu.css" rel="stylesheet">
  <link href="../site_libs/revealjs/plugin/reveal-menu/quarto-menu.css" rel="stylesheet">
  <link href="../site_libs/revealjs/plugin/quarto-support/footer.css" rel="stylesheet">
  <style type="text/css">
    .reveal div.sourceCode {
      margin: 0;
      overflow: auto;
    }
    .reveal div.hanging-indent {
      margin-left: 1em;
      text-indent: -1em;
    }
    .reveal .slide:not(.center) {
      height: 100%;
    }
    .reveal .slide.scrollable {
      overflow-y: auto;
    }
    .reveal .footnotes {
      height: 100%;
      overflow-y: auto;
    }
    .reveal .slide .absolute {
      position: absolute;
      display: block;
    }
    .reveal .footnotes ol {
      counter-reset: ol;
      list-style-type: none; 
      margin-left: 0;
    }
    .reveal .footnotes ol li:before {
      counter-increment: ol;
      content: counter(ol) ". "; 
    }
    .reveal .footnotes ol li > p:first-child {
      display: inline-block;
    }
    .reveal .slide ul,
    .reveal .slide ol {
      margin-bottom: 0.5em;
    }
    .reveal .slide ul li,
    .reveal .slide ol li {
      margin-top: 0.4em;
      margin-bottom: 0.2em;
    }
    .reveal .slide ul[role="tablist"] li {
      margin-bottom: 0;
    }
    .reveal .slide ul li > *:first-child,
    .reveal .slide ol li > *:first-child {
      margin-block-start: 0;
    }
    .reveal .slide ul li > *:last-child,
    .reveal .slide ol li > *:last-child {
      margin-block-end: 0;
    }
    .reveal .slide .columns:nth-child(3) {
      margin-block-start: 0.8em;
    }
    .reveal blockquote {
      box-shadow: none;
    }
    .reveal .tippy-content>* {
      margin-top: 0.2em;
      margin-bottom: 0.7em;
    }
    .reveal .tippy-content>*:last-child {
      margin-bottom: 0.2em;
    }
    .reveal .slide > img.stretch.quarto-figure-center,
    .reveal .slide > img.r-stretch.quarto-figure-center {
      display: block;
      margin-left: auto;
      margin-right: auto; 
    }
    .reveal .slide > img.stretch.quarto-figure-left,
    .reveal .slide > img.r-stretch.quarto-figure-left  {
      display: block;
      margin-left: 0;
      margin-right: auto; 
    }
    .reveal .slide > img.stretch.quarto-figure-right,
    .reveal .slide > img.r-stretch.quarto-figure-right  {
      display: block;
      margin-left: auto;
      margin-right: 0; 
    }
  </style>
  <link rel="shortcut icon" href="../assets/images/faviconpsicostat2.png">

</head>
<body class="quarto-light">
  <div class="reveal">
    <div class="slides">

<section id="title-slide" data-background-image="../assets/images/psicostatLogo.png" data-background-opacity="0.15" data-background-size="contain" class="quarto-title-block center">
  <h1 class="title">Longitudinal SEM: Growth + Invariance Over Time</h1>
  <p class="subtitle">Latent Growth Models &amp; Measurement Invariance Across Waves</p>

<div class="quarto-title-authors">
<div class="quarto-title-author">
<div class="quarto-title-author-name">
Tommaso Feraco 
</div>
</div>
</div>

</section>
<section id="today-in-the-workflow" class="slide level2">
<h2>Today in the workflow</h2>
<p><strong>Specify → Identify → Estimate → Evaluate → Revise/Report</strong></p>
<div class="callout callout-note no-icon callout-style-simple">
<div class="callout-body">
<div class="callout-content">
<p><strong>Today:</strong> <em>measurement</em> in a <em>longitudinal</em> fashion.<br>
<strong>Growth:</strong> measuring and testing change in latent variables.</p>
</div>
</div>
</div>
</section>
<section id="learning-objectives" class="slide level2">
<h2>Learning objectives</h2>
<p>By the end of today you can:</p>
<ol type="1">
<li>Fit and justify <strong>measurement invariance over time</strong> (longitudinal CFA).</li>
<li>Specify and estimate <strong>latent growth curve models (LGM)</strong> in SEM form.</li>
<li>Interpret growth parameters (means, variances, covariances) and understand <strong>time coding</strong>.</li>
<li>Use <strong>global + local diagnostics</strong> to decide on <em>disciplined</em> respecification.</li>
</ol>
</section>
<section id="what-question-are-we-asking" class="slide level2">
<h2>What question are we asking?</h2>
<p>Longitudinal SEM is not one model, but a family of models.</p>
<div class="callout callout-tip callout-titled callout-style-default">
<div class="callout-body">
<div class="callout-title">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<p><strong>Tip</strong></p>
</div>
<div class="callout-content">
<p><strong>Choose the model family from the scientific question:</strong></p>
<ul>
<li><strong>Growth (LGM):</strong> “How do people change on average? How do trajectories differ?”</li>
<li><strong>Stability / lagged prediction (CLPM/RI-CLPM):</strong> “Do individual changes predict later changes?”</li>
<li><strong>Change processes (LCS):</strong> “How is change from t→t+1 driven/coupled?”</li>
</ul>
</div>
</div>
</div>
<p>Today: <strong>Invariance over time + LGM (growth)</strong>.<br>
RI-CLPM and LCS are linked as extras later.</p>
</section>
<section id="minimal-key-concept-measurement-first-two-step" class="slide level2">
<h2>Minimal key concept: measurement-first (two-step)</h2>
<p><strong>Two-step mindset</strong></p>
<ol type="1">
<li><strong>Measurement model</strong>: is the construct measured comparably across waves?<br>
</li>
<li><strong>Structural/growth model</strong>: only then interpret change parameters.</li>
</ol>
<p>If measurement shifts over time, “growth” can become a mixture of:</p>
<ul>
<li>true change in the latent construct</li>
<li>changes in item functioning / scaling / intercepts</li>
</ul>
</section>
<section class="slide level2">

</section>
<section>
<section id="longitudinal-invariance" class="title-slide slide level1 center">
<h1>Longitudinal invariance</h1>

</section>
<section id="longitudinal-invariance-ladder" class="slide level2">
<h2>Longitudinal invariance ladder</h2>
<p>Measurement waves are our “groups” for the MG-CFA.</p>
<ul>
<li><strong>Configural:</strong> same factor structure each wave</li>
<li><strong>Metric:</strong> equal loadings (<span class="math inline">\(Λ\)</span>) across waves</li>
<li><strong>Scalar:</strong> equal intercepts (<span class="math inline">\(τ\)</span>) across waves<br>
→ necessary for <strong>latent mean / growth mean</strong> interpretation</li>
</ul>
<div class="callout callout-warning callout-titled callout-style-default">
<div class="callout-body">
<div class="callout-title">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<p><strong>Warning</strong></p>
</div>
<div class="callout-content">
<p><strong>Key point:</strong> Without at least (partial) <strong>scalar invariance</strong>, mean differences over time can be artifacts of shifting intercepts (thresholds for ordinal items).</p>
</div>
</div>
</div>
</section>
<section id="identification-reminders-longitudinal-cfa" class="slide level2">
<h2>Identification reminders (longitudinal CFA)</h2>
<p>For each wave:</p>
<ul>
<li>Fix factor scale (e.g., one loading = 1, or factor variance = 1)</li>
<li>With multiple waves, keep scaling consistent across time</li>
</ul>
<p>In longitudinal CFA with <strong>means</strong>, the usual identification logic extends:</p>
<ul>
<li>Intercepts and factor means can’t all be free without constraints</li>
<li>In lavaan, a standard way is <strong>fix factor mean at wave 1 to 0</strong> and estimate others (or use growth factors later)</li>
</ul>
</section>
<section id="diagram-longitudinal-cfa" class="slide level2">
<h2>Diagram: longitudinal CFA</h2>

<img data-src="09_longitudinal-sem_growth_invariance-over-time_files/figure-revealjs/unnamed-chunk-1-1.png" width="960" class="r-stretch"></section>
<section id="live-coding-setup" class="slide level2">
<h2>Live coding setup</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(lavaan)</span>
<span id="cb1-2"><a aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(semTools)</span>
<span id="cb1-3"><a aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb1-4"><a aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-5"><a aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">12345</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="example-data-transparent-simulation" class="slide level2">
<h2>Example data (transparent simulation)</h2>
<div style="font-size:0.5em; line-height:1.15;">
<div class="{columns}">
<div class="column" style="width:30%;">
<p>We simulate:</p>
<ul>
<li>One latent trait at each wave</li>
<li>Strong stability (correlated factors over time)</li>
<li>Some correlated residuals for the same indicator across waves (realistic)</li>
<li>Later we impose invariance constraints in fitting</li>
</ul>
<div class="callout callout-note callout-titled callout-style-default">
<div class="callout-body">
<div class="callout-title">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<p><strong>Note</strong></p>
</div>
<div class="callout-content">
<p>We set <code>meanstructure = TRUE</code> in simulation to generate item intercepts + means consistently with the population model.</p>
</div>
</div>
</div>
</div><div class="column" style="width:70%;">
<div class="cell">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a aria-hidden="true" tabindex="-1"></a>pop <span class="ot">&lt;-</span> <span class="st">'</span></span>
<span id="cb2-2"><a aria-hidden="true" tabindex="-1"></a><span class="st"># Wave 1 factor</span></span>
<span id="cb2-3"><a aria-hidden="true" tabindex="-1"></a><span class="st">F1 =~ 1*y1_1 + .8*y2_1 + .9*y3_1 + .7*y4_1</span></span>
<span id="cb2-4"><a aria-hidden="true" tabindex="-1"></a><span class="st"># Wave 2 factor</span></span>
<span id="cb2-5"><a aria-hidden="true" tabindex="-1"></a><span class="st">F2 =~ 1*y1_2 + .8*y2_2 + .9*y3_2 + .7*y4_2</span></span>
<span id="cb2-6"><a aria-hidden="true" tabindex="-1"></a><span class="st"># Wave 3 factor</span></span>
<span id="cb2-7"><a aria-hidden="true" tabindex="-1"></a><span class="st">F3 =~ 1*y1_3 + .8*y2_3 + .9*y3_3 + .7*y4_3</span></span>
<span id="cb2-8"><a aria-hidden="true" tabindex="-1"></a><span class="st"># Wave 4 factor</span></span>
<span id="cb2-9"><a aria-hidden="true" tabindex="-1"></a><span class="st">F4 =~ 1*y1_4 + .8*y2_4 + .9*y3_4 + .7*y4_4</span></span>
<span id="cb2-10"><a aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-11"><a aria-hidden="true" tabindex="-1"></a><span class="st"># Factor means (0 baseline; increasing means)</span></span>
<span id="cb2-12"><a aria-hidden="true" tabindex="-1"></a><span class="st">F1 ~ 0*1</span></span>
<span id="cb2-13"><a aria-hidden="true" tabindex="-1"></a><span class="st">F2 ~ .2*1</span></span>
<span id="cb2-14"><a aria-hidden="true" tabindex="-1"></a><span class="st">F3 ~ .5*1</span></span>
<span id="cb2-15"><a aria-hidden="true" tabindex="-1"></a><span class="st">F4 ~ .8*1</span></span>
<span id="cb2-16"><a aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-17"><a aria-hidden="true" tabindex="-1"></a><span class="st"># Factor variances</span></span>
<span id="cb2-18"><a aria-hidden="true" tabindex="-1"></a><span class="st">F1 ~~ 1*F1</span></span>
<span id="cb2-19"><a aria-hidden="true" tabindex="-1"></a><span class="st">F2 ~~ 1*F2</span></span>
<span id="cb2-20"><a aria-hidden="true" tabindex="-1"></a><span class="st">F3 ~~ 1*F3</span></span>
<span id="cb2-21"><a aria-hidden="true" tabindex="-1"></a><span class="st">F4 ~~ 1*F4</span></span>
<span id="cb2-22"><a aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-23"><a aria-hidden="true" tabindex="-1"></a><span class="st"># Stability (correlations)</span></span>
<span id="cb2-24"><a aria-hidden="true" tabindex="-1"></a><span class="st">F1 ~~ .70*F2</span></span>
<span id="cb2-25"><a aria-hidden="true" tabindex="-1"></a><span class="st">F2 ~~ .75*F3</span></span>
<span id="cb2-26"><a aria-hidden="true" tabindex="-1"></a><span class="st">F3 ~~ .80*F4</span></span>
<span id="cb2-27"><a aria-hidden="true" tabindex="-1"></a><span class="st">F1 ~~ .60*F3</span></span>
<span id="cb2-28"><a aria-hidden="true" tabindex="-1"></a><span class="st">F2 ~~ .65*F4</span></span>
<span id="cb2-29"><a aria-hidden="true" tabindex="-1"></a><span class="st">F1 ~~ .55*F4</span></span>
<span id="cb2-30"><a aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-31"><a aria-hidden="true" tabindex="-1"></a><span class="st"># Residual variances (items)</span></span>
<span id="cb2-32"><a aria-hidden="true" tabindex="-1"></a><span class="st">y1_1 ~~ .5*y1_1; y2_1 ~~ .6*y2_1; y3_1 ~~ .5*y3_1; y4_1 ~~ .7*y4_1</span></span>
<span id="cb2-33"><a aria-hidden="true" tabindex="-1"></a><span class="st">y1_2 ~~ .5*y1_2; y2_2 ~~ .6*y2_2; y3_2 ~~ .5*y3_2; y4_2 ~~ .7*y4_2</span></span>
<span id="cb2-34"><a aria-hidden="true" tabindex="-1"></a><span class="st">y1_3 ~~ .5*y1_3; y2_3 ~~ .6*y2_3; y3_3 ~~ .5*y3_3; y4_3 ~~ .7*y4_3</span></span>
<span id="cb2-35"><a aria-hidden="true" tabindex="-1"></a><span class="st">y1_4 ~~ .5*y1_4; y2_4 ~~ .6*y2_4; y3_4 ~~ .5*y3_4; y4_4 ~~ .7*y4_4</span></span>
<span id="cb2-36"><a aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-37"><a aria-hidden="true" tabindex="-1"></a><span class="st"># Correlated residuals across adjacent waves for same indicator (method/wording carryover)</span></span>
<span id="cb2-38"><a aria-hidden="true" tabindex="-1"></a><span class="st">y1_1 ~~ .25*y1_2</span></span>
<span id="cb2-39"><a aria-hidden="true" tabindex="-1"></a><span class="st">y1_2 ~~ .25*y1_3</span></span>
<span id="cb2-40"><a aria-hidden="true" tabindex="-1"></a><span class="st">y1_3 ~~ .25*y1_4</span></span>
<span id="cb2-41"><a aria-hidden="true" tabindex="-1"></a><span class="st">y2_1 ~~ .20*y2_2</span></span>
<span id="cb2-42"><a aria-hidden="true" tabindex="-1"></a><span class="st">y2_2 ~~ .20*y2_3</span></span>
<span id="cb2-43"><a aria-hidden="true" tabindex="-1"></a><span class="st">y2_3 ~~ .20*y2_4</span></span>
<span id="cb2-44"><a aria-hidden="true" tabindex="-1"></a><span class="st">'</span></span>
<span id="cb2-45"><a aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-46"><a aria-hidden="true" tabindex="-1"></a>dat <span class="ot">&lt;-</span> <span class="fu">simulateData</span>(pop, <span class="at">sample.nobs =</span> <span class="dv">6000</span>, <span class="at">meanstructure =</span> <span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div></div>
</div>
</section>
<section id="step-1-configural-longitudinal-cfa" class="slide level2">
<h2>Step 1: Configural longitudinal CFA</h2>
<p>We specify one factor per wave, same indicators each wave.<br>
We also allow <em>conceptually justified</em> correlated residuals (same items).</p>
<div style="font-size:0.8em; line-height:1.15;">
<div class="cell">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a aria-hidden="true" tabindex="-1"></a>mod_config <span class="ot">&lt;-</span> <span class="st">'</span></span>
<span id="cb3-2"><a aria-hidden="true" tabindex="-1"></a><span class="st">F1 =~ y1_1 + y2_1 + y3_1 + y4_1</span></span>
<span id="cb3-3"><a aria-hidden="true" tabindex="-1"></a><span class="st">F2 =~ y1_2 + y2_2 + y3_2 + y4_2</span></span>
<span id="cb3-4"><a aria-hidden="true" tabindex="-1"></a><span class="st">F3 =~ y1_3 + y2_3 + y3_3 + y4_3</span></span>
<span id="cb3-5"><a aria-hidden="true" tabindex="-1"></a><span class="st">F4 =~ y1_4 + y2_4 + y3_4 + y4_4</span></span>
<span id="cb3-6"><a aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-7"><a aria-hidden="true" tabindex="-1"></a><span class="st"># correlated residuals for the same item across adjacent waves </span></span>
<span id="cb3-8"><a aria-hidden="true" tabindex="-1"></a><span class="st">y1_1 ~~ y1_2</span></span>
<span id="cb3-9"><a aria-hidden="true" tabindex="-1"></a><span class="st">y1_2 ~~ y1_3</span></span>
<span id="cb3-10"><a aria-hidden="true" tabindex="-1"></a><span class="st">y1_3 ~~ y1_4</span></span>
<span id="cb3-11"><a aria-hidden="true" tabindex="-1"></a><span class="st">y2_1 ~~ y2_2</span></span>
<span id="cb3-12"><a aria-hidden="true" tabindex="-1"></a><span class="st">y2_2 ~~ y2_3</span></span>
<span id="cb3-13"><a aria-hidden="true" tabindex="-1"></a><span class="st">y2_3 ~~ y2_4</span></span>
<span id="cb3-14"><a aria-hidden="true" tabindex="-1"></a><span class="st">'</span></span>
<span id="cb3-15"><a aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-16"><a aria-hidden="true" tabindex="-1"></a>fit_config <span class="ot">&lt;-</span> <span class="fu">cfa</span>(mod_config, <span class="at">data =</span> dat, <span class="at">meanstructure =</span> <span class="cn">TRUE</span>)</span>
<span id="cb3-17"><a aria-hidden="true" tabindex="-1"></a><span class="fu">fitMeasures</span>(fit_config, <span class="fu">c</span>(<span class="st">"chisq"</span>,<span class="st">"df"</span>,<span class="st">"cfi"</span>,<span class="st">"tli"</span>,<span class="st">"rmsea"</span>,<span class="st">"srmr"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> chisq     df    cfi    tli  rmsea   srmr 
85.683 92.000  1.000  1.000  0.000  0.007 </code></pre>
</div>
</div>
</div>
</section>
<section id="step-2-metric-invariance-equal-loadings" class="slide level2">
<h2>Step 2: Metric invariance: equal loadings</h2>
<div style="font-size:0.8em; line-height:1.15;">
<div class="cell">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a aria-hidden="true" tabindex="-1"></a>mod_metric <span class="ot">&lt;-</span> <span class="st">'</span></span>
<span id="cb5-2"><a aria-hidden="true" tabindex="-1"></a><span class="st"># equal loadings across timepoints</span></span>
<span id="cb5-3"><a aria-hidden="true" tabindex="-1"></a><span class="st">F1 =~ l1*y1_1 + l2*y2_1 + l3*y3_1 + l4*y4_1</span></span>
<span id="cb5-4"><a aria-hidden="true" tabindex="-1"></a><span class="st">F2 =~ l1*y1_2 + l2*y2_2 + l3*y3_2 + l4*y4_2</span></span>
<span id="cb5-5"><a aria-hidden="true" tabindex="-1"></a><span class="st">F3 =~ l1*y1_3 + l2*y2_3 + l3*y3_3 + l4*y4_3</span></span>
<span id="cb5-6"><a aria-hidden="true" tabindex="-1"></a><span class="st">F4 =~ l1*y1_4 + l2*y2_4 + l3*y3_4 + l4*y4_4</span></span>
<span id="cb5-7"><a aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-8"><a aria-hidden="true" tabindex="-1"></a><span class="st"># correlated residuals </span></span>
<span id="cb5-9"><a aria-hidden="true" tabindex="-1"></a><span class="st">y1_1 ~~ y1_2</span></span>
<span id="cb5-10"><a aria-hidden="true" tabindex="-1"></a><span class="st">y1_2 ~~ y1_3</span></span>
<span id="cb5-11"><a aria-hidden="true" tabindex="-1"></a><span class="st">y1_3 ~~ y1_4</span></span>
<span id="cb5-12"><a aria-hidden="true" tabindex="-1"></a><span class="st">y2_1 ~~ y2_2</span></span>
<span id="cb5-13"><a aria-hidden="true" tabindex="-1"></a><span class="st">y2_2 ~~ y2_3</span></span>
<span id="cb5-14"><a aria-hidden="true" tabindex="-1"></a><span class="st">y2_3 ~~ y2_4</span></span>
<span id="cb5-15"><a aria-hidden="true" tabindex="-1"></a><span class="st">'</span></span>
<span id="cb5-16"><a aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-17"><a aria-hidden="true" tabindex="-1"></a>fit_metric <span class="ot">&lt;-</span> <span class="fu">cfa</span>(mod_metric, <span class="at">data =</span> dat, <span class="at">meanstructure =</span> <span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</section>
<section id="step-3-scalar-invariance-equal-intercepts-too" class="slide level2">
<h2>Step 3: Scalar invariance: equal intercepts too</h2>
<div style="font-size:0.8em; line-height:1.15;">
<div class="cell">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a aria-hidden="true" tabindex="-1"></a>mod_scalar <span class="ot">&lt;-</span> <span class="st">'</span></span>
<span id="cb6-2"><a aria-hidden="true" tabindex="-1"></a><span class="st"># equal loadings across timepoints</span></span>
<span id="cb6-3"><a aria-hidden="true" tabindex="-1"></a><span class="st">F1 =~ l1*y1_1 + l2*y2_1 + l3*y3_1 + l4*y4_1</span></span>
<span id="cb6-4"><a aria-hidden="true" tabindex="-1"></a><span class="st">F2 =~ l1*y1_2 + l2*y2_2 + l3*y3_2 + l4*y4_2</span></span>
<span id="cb6-5"><a aria-hidden="true" tabindex="-1"></a><span class="st">F3 =~ l1*y1_3 + l2*y2_3 + l3*y3_3 + l4*y4_3</span></span>
<span id="cb6-6"><a aria-hidden="true" tabindex="-1"></a><span class="st">F4 =~ l1*y1_4 + l2*y2_4 + l3*y3_4 + l4*y4_4</span></span>
<span id="cb6-7"><a aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-8"><a aria-hidden="true" tabindex="-1"></a><span class="st"># equal intercepts across time</span></span>
<span id="cb6-9"><a aria-hidden="true" tabindex="-1"></a><span class="st">y1_1 ~ i1*1; y1_2 ~ i1*1; y1_3 ~ i1*1; y1_4 ~ i1*1</span></span>
<span id="cb6-10"><a aria-hidden="true" tabindex="-1"></a><span class="st">y2_1 ~ i2*1; y2_2 ~ i2*1; y2_3 ~ i2*1; y2_4 ~ i2*1</span></span>
<span id="cb6-11"><a aria-hidden="true" tabindex="-1"></a><span class="st">y3_1 ~ i3*1; y3_2 ~ i3*1; y3_3 ~ i3*1; y3_4 ~ i3*1</span></span>
<span id="cb6-12"><a aria-hidden="true" tabindex="-1"></a><span class="st">y4_1 ~ i4*1; y4_2 ~ i4*1; y4_3 ~ i4*1; y4_4 ~ i4*1</span></span>
<span id="cb6-13"><a aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-14"><a aria-hidden="true" tabindex="-1"></a><span class="st"># correlated residuals </span></span>
<span id="cb6-15"><a aria-hidden="true" tabindex="-1"></a><span class="st">y1_1 ~~ y1_2</span></span>
<span id="cb6-16"><a aria-hidden="true" tabindex="-1"></a><span class="st">y1_2 ~~ y1_3</span></span>
<span id="cb6-17"><a aria-hidden="true" tabindex="-1"></a><span class="st">y1_3 ~~ y1_4</span></span>
<span id="cb6-18"><a aria-hidden="true" tabindex="-1"></a><span class="st">y2_1 ~~ y2_2</span></span>
<span id="cb6-19"><a aria-hidden="true" tabindex="-1"></a><span class="st">y2_2 ~~ y2_3</span></span>
<span id="cb6-20"><a aria-hidden="true" tabindex="-1"></a><span class="st">y2_3 ~~ y2_4</span></span>
<span id="cb6-21"><a aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-22"><a aria-hidden="true" tabindex="-1"></a><span class="st"># free means</span></span>
<span id="cb6-23"><a aria-hidden="true" tabindex="-1"></a><span class="st">F1 ~ 0*1</span></span>
<span id="cb6-24"><a aria-hidden="true" tabindex="-1"></a><span class="st">F2 ~ m2*1</span></span>
<span id="cb6-25"><a aria-hidden="true" tabindex="-1"></a><span class="st">F3 ~ m3*1</span></span>
<span id="cb6-26"><a aria-hidden="true" tabindex="-1"></a><span class="st">F4 ~ m4*1</span></span>
<span id="cb6-27"><a aria-hidden="true" tabindex="-1"></a><span class="st">'</span></span>
<span id="cb6-28"><a aria-hidden="true" tabindex="-1"></a>fit_scalar <span class="ot">&lt;-</span> <span class="fu">cfa</span>(mod_scalar, <span class="at">data =</span> dat, <span class="at">meanstructure =</span> <span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div class="callout callout-tip callout-titled callout-style-default">
<div class="callout-body">
<div class="callout-title">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<p><strong>Tip</strong></p>
</div>
<div class="callout-content">
<p>Freeing means could be essential if there is actual mean change.</p>
</div>
</div>
</div>
</section>
<section id="evaluate-invariance-fit-comparisons" class="slide level2">
<h2>Evaluate invariance: fit comparisons</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a aria-hidden="true" tabindex="-1"></a><span class="fu">lavTestLRT</span>(fit_config, fit_metric, fit_scalar)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Chi-Squared Difference Test

            Df    AIC    BIC Chisq Chisq diff   RMSEA Df diff Pr(&gt;Chisq)
fit_config  92 246326 246728  85.7                                      
fit_metric 101 246315 246657  92.7       7.06 0.00000       9       0.63
fit_scalar 110 246309 246591 105.3      12.57 0.00813       9       0.18</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a aria-hidden="true" tabindex="-1"></a><span class="fu">data.frame</span>(<span class="fu">bind_rows</span>(</span>
<span id="cb9-2"><a aria-hidden="true" tabindex="-1"></a>  <span class="at">config =</span> <span class="fu">fitMeasures</span>(fit_config, <span class="fu">c</span>(<span class="st">"cfi"</span>,<span class="st">"rmsea"</span>,<span class="st">"srmr"</span>)),</span>
<span id="cb9-3"><a aria-hidden="true" tabindex="-1"></a>  <span class="at">metric =</span> <span class="fu">fitMeasures</span>(fit_metric, <span class="fu">c</span>(<span class="st">"cfi"</span>,<span class="st">"rmsea"</span>,<span class="st">"srmr"</span>)),</span>
<span id="cb9-4"><a aria-hidden="true" tabindex="-1"></a>  <span class="at">scalar =</span> <span class="fu">fitMeasures</span>(fit_scalar, <span class="fu">c</span>(<span class="st">"cfi"</span>,<span class="st">"rmsea"</span>,<span class="st">"srmr"</span>)),<span class="at">.id =</span> <span class="st">"model"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   model cfi rmsea    srmr
1 config   1     0 0.00684
2 metric   1     0 0.00891
3 scalar   1     0 0.00929</code></pre>
</div>
</div>
<div class="callout callout-tip callout-titled callout-style-default">
<div class="callout-body">
<div class="callout-title">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<p><strong>Tip</strong></p>
</div>
<div class="callout-content">
<p>Always check <em>where</em> misfit arises (local diagnostics).</p>
</div>
</div>
</div>
</section>
<section id="diagnostics-global-vs-local-fit-in-invariance" class="slide level2">
<h2>Diagnostics: global vs local fit (in invariance)</h2>
<p><strong>Global</strong>: χ², CFI/TLI, RMSEA (+CI), SRMR</p>
<p><strong>Local</strong>:</p>
<ul>
<li>standardized residuals</li>
<li>modification indices (MI)</li>
<li>inspect which items/waves break invariance</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a aria-hidden="true" tabindex="-1"></a><span class="co"># Local diagnostics example</span></span>
<span id="cb11-2"><a aria-hidden="true" tabindex="-1"></a>mi <span class="ot">&lt;-</span> <span class="fu">modificationIndices</span>(fit_scalar)</span>
<span id="cb11-3"><a aria-hidden="true" tabindex="-1"></a>mi <span class="sc">|&gt;</span> <span class="fu">arrange</span>(<span class="fu">desc</span>(mi)) <span class="sc">|&gt;</span> <span class="fu">head</span>(<span class="dv">10</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>    lhs op  rhs   mi    epc sepc.lv sepc.all sepc.nox
1  y1_1 ~~ y4_1 7.95 -0.027  -0.027   -0.044   -0.044
2    F2 =~ y1_1 5.27  0.027   0.027    0.022    0.022
3    F3 =~ y1_1 5.03  0.024   0.023    0.019    0.019
4    F2 =~ y4_1 3.95 -0.025  -0.025   -0.023   -0.023
5    F1 =~ y4_4 3.75  0.025   0.025    0.023    0.023
6  y4_3 ~~ y2_4 3.70  0.017   0.017    0.026    0.026
7    F1 =~ y4_3 3.56 -0.024  -0.024   -0.023   -0.023
8    F2 =~ y4_4 3.45  0.024   0.024    0.022    0.022
9  y3_1 ~~ y4_3 3.31 -0.017  -0.017   -0.028   -0.028
10 y4_1 ~~ y2_2 3.17 -0.015  -0.015   -0.023   -0.023</code></pre>
</div>
</div>
</section>
<section id="pitfallcallout-partial-invariance-fishing" class="slide level2">
<h2>Pitfall/callout: “Partial invariance = fishing?”</h2>
<div class="callout callout-warning callout-titled callout-style-default">
<div class="callout-body">
<div class="callout-title">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<p><strong>Warning</strong></p>
</div>
<div class="callout-content">
<p><strong>Partial invariance is not “cheating”</strong> if done transparently:</p>
<ul>
<li>free the smallest number of parameters</li>
<li>justify based on item content / design changes</li>
<li>report which parameters were freed</li>
<li>verify conclusions are robust (sensitivity)</li>
</ul>
</div>
</div>
</div>
<p>A good practice: free one intercept (or loading) at a time guided by theory + MI, then reassess.</p>
</section>
<section class="slide level2">

</section></section>
<section>
<section id="from-time-invariance-to-growth" class="title-slide slide level1 center">
<h1>From time invariance to growth</h1>

</section>
<section id="transition-from-invariance-to-growth" class="slide level2">
<h2>Transition: from invariance to growth</h2>
<p>If longitudinal <strong>(partial) scalar invariance</strong> holds, we can interpret latent means over time (like we did for group comparisons in MG-CFA).</p>
<p>Growth models re-express these latent means as a trajectory using <strong>growth factors</strong>:</p>
<ul>
<li><strong>Intercept factor (i):</strong> baseline level (at a chosen time point)</li>
<li><strong>Slope factor (s):</strong> rate of change (linear, unless extended)
<ul>
<li>Optional: quadratic slope, piecewise slopes…</li>
</ul></li>
</ul>
</section>
<section id="transition-from-invariance-to-growth-1" class="slide level2">
<h2>Transition: from invariance to growth</h2>
<p>What questions do you answer with latent growth models?</p>
<ul>
<li>What is the average trajectory for <em>all</em> respondents?
<ul>
<li>What is their initial value (i.e., mean)?</li>
<li>Is there any change?
<ul>
<li>What’s the form of the change</li>
</ul></li>
</ul></li>
<li>Is the average trajectory enough or participants vary in their trajectories?
<ul>
<li>random effects of intercepts and slope</li>
</ul></li>
<li>Are random effects explainable? How? Do we need more variables?</li>
</ul>
</section>
<section id="minimal-math-lgm-as-cfa-with-time-scores" class="slide level2">
<h2>Minimal math: LGM as CFA with time scores</h2>
<p>For person <em>n</em> at time <em>t</em>:</p>
<p><span class="math display">\[
\eta_{nt} = i_n + \lambda_t s_n + \varepsilon_{nt}
\]</span></p>
<ul>
<li><span class="math inline">\((i_n)\)</span> and <span class="math inline">\((s_n)\)</span> are latent variables (random effects)</li>
<li><span class="math inline">\((\lambda_t)\)</span> are fixed <strong>time scores</strong> (e.g., 0,1,2,3)</li>
<li><span class="math inline">\((\varepsilon_{nt})\)</span> are time-specific residuals</li>
</ul>
<p>Means and variances:</p>
<ul>
<li><span class="math inline">\((E(i_n) = \mu_i)\)</span>, <span class="math inline">\((Var(i_n)=\sigma_i^2)\)</span></li>
<li><span class="math inline">\((E(s_n) = \mu_s)\)</span>, <span class="math inline">\((Var(s_n)=\sigma_s^2)\)</span></li>
<li><span class="math inline">\((Cov(i_n,s_n)=\sigma_{is})\)</span></li>
</ul>
</section>
<section id="diagram-growth-model-intercept-slope" class="slide level2">
<h2>Diagram: growth model (intercept + slope)</h2>

<img data-src="../assets/images/lgcm_basic.jpg" class="r-stretch"><div class="callout callout-note callout-titled callout-style-default">
<div class="callout-body">
<div class="callout-title">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<p><strong>Note</strong></p>
</div>
<div class="callout-content">
<p>This is a linear <strong>second-order</strong> latent growth curve model</p>
</div>
</div>
</div>
</section>
<section id="lgm-on-observed-composites" class="slide level2">
<h2>LGM on observed composites</h2>
<p>We’ll start with a simple observed repeated measure (think: scale score).</p>
<p>In practice, you often combine:</p>
<ul>
<li>longitudinal invariance CFA for measurement</li>
<li>then growth model on latent factors (“second-order” growth)</li>
</ul>
<p>Create an observed score per wave from the data we used before:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a aria-hidden="true" tabindex="-1"></a>dat <span class="ot">&lt;-</span> dat <span class="sc">|&gt;</span></span>
<span id="cb13-2"><a aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb13-3"><a aria-hidden="true" tabindex="-1"></a>    <span class="at">y_t1 =</span> <span class="fu">rowMeans</span>(<span class="fu">across</span>(<span class="fu">c</span>(y1_1,y2_1,y3_1,y4_1))),</span>
<span id="cb13-4"><a aria-hidden="true" tabindex="-1"></a>    <span class="at">y_t2 =</span> <span class="fu">rowMeans</span>(<span class="fu">across</span>(<span class="fu">c</span>(y1_2,y2_2,y3_2,y4_2))),</span>
<span id="cb13-5"><a aria-hidden="true" tabindex="-1"></a>    <span class="at">y_t3 =</span> <span class="fu">rowMeans</span>(<span class="fu">across</span>(<span class="fu">c</span>(y1_3,y2_3,y3_3,y4_3))),</span>
<span id="cb13-6"><a aria-hidden="true" tabindex="-1"></a>    <span class="at">y_t4 =</span> <span class="fu">rowMeans</span>(<span class="fu">across</span>(<span class="fu">c</span>(y1_4,y2_4,y3_4,y4_4)))</span>
<span id="cb13-7"><a aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="callout callout-warning callout-titled callout-style-default">
<div class="callout-body">
<div class="callout-title">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<p><strong>Warning</strong></p>
</div>
<div class="callout-content">
<p>(teaching-friendly less publication/SEM-friendly)</p>
</div>
</div>
</div>
</section>
<section id="linear-growth-model-in-lavaan" class="slide level2">
<h2>Linear growth model in lavaan</h2>
<p>In <code>lavaan</code>, <code>growth()</code> is a convenience wrapper that fits an SEM with <code>meanstructure=TRUE</code> by default (needed to estimate growth means). If you use <code>sem()</code>/<code>cfa()</code>, you must set it explicitly.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a aria-hidden="true" tabindex="-1"></a>lgm_linear <span class="ot">&lt;-</span> <span class="st">'</span></span>
<span id="cb14-2"><a aria-hidden="true" tabindex="-1"></a><span class="st"># growth factors</span></span>
<span id="cb14-3"><a aria-hidden="true" tabindex="-1"></a><span class="st">i =~ 1*y_t1 + 1*y_t2 + 1*y_t3 + 1*y_t4</span></span>
<span id="cb14-4"><a aria-hidden="true" tabindex="-1"></a><span class="st">s =~ 0*y_t1 + 1*y_t2 + 2*y_t3 + 3*y_t4</span></span>
<span id="cb14-5"><a aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-6"><a aria-hidden="true" tabindex="-1"></a><span class="st"># (optional) allow residual autocorrelation</span></span>
<span id="cb14-7"><a aria-hidden="true" tabindex="-1"></a><span class="st">y_t1 ~~ y_t2</span></span>
<span id="cb14-8"><a aria-hidden="true" tabindex="-1"></a><span class="st">y_t2 ~~ y_t3</span></span>
<span id="cb14-9"><a aria-hidden="true" tabindex="-1"></a><span class="st">y_t3 ~~ y_t4</span></span>
<span id="cb14-10"><a aria-hidden="true" tabindex="-1"></a><span class="st">'</span></span>
<span id="cb14-11"><a aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-12"><a aria-hidden="true" tabindex="-1"></a>fit_lgm <span class="ot">&lt;-</span> <span class="fu">growth</span>(lgm_linear, <span class="at">data =</span> dat)  <span class="co"># meanstructure handled</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="callout callout-warning callout-titled callout-style-default">
<div class="callout-body">
<div class="callout-title">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<p><strong>Warning</strong></p>
</div>
<div class="callout-content">
<p>This model is already assuming random intercepts and slopes</p>
</div>
</div>
</div>
</section>
<section id="the-growth-summary" class="slide level2">
<h2>The growth summary</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(fit_lgm, <span class="at">fit.measures =</span> <span class="cn">TRUE</span>, <span class="at">standardized =</span> <span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>lavaan 0.6-19 ended normally after 26 iterations

  Estimator                                         ML
  Optimization method                           NLMINB
  Number of model parameters                        12

  Number of observations                          6000

Model Test User Model:
                                                      
  Test statistic                                39.720
  Degrees of freedom                                 2
  P-value (Chi-square)                           0.000

Model Test Baseline Model:

  Test statistic                             10572.830
  Degrees of freedom                                 6
  P-value                                        0.000

User Model versus Baseline Model:

  Comparative Fit Index (CFI)                    0.996
  Tucker-Lewis Index (TLI)                       0.989

Loglikelihood and Information Criteria:

  Loglikelihood user model (H0)             -26907.698
  Loglikelihood unrestricted model (H1)     -26887.838
                                                      
  Akaike (AIC)                               53839.396
  Bayesian (BIC)                             53919.790
  Sample-size adjusted Bayesian (SABIC)      53881.658

Root Mean Square Error of Approximation:

  RMSEA                                          0.056
  90 Percent confidence interval - lower         0.042
  90 Percent confidence interval - upper         0.072
  P-value H_0: RMSEA &lt;= 0.050                    0.230
  P-value H_0: RMSEA &gt;= 0.080                    0.006

Standardized Root Mean Square Residual:

  SRMR                                           0.014

Parameter Estimates:

  Standard errors                             Standard
  Information                                 Expected
  Information saturated (h1) model          Structured

Latent Variables:
                   Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all
  i =~                                                                  
    y_t1              1.000                               0.691    0.742
    y_t2              1.000                               0.691    0.741
    y_t3              1.000                               0.691    0.750
    y_t4              1.000                               0.691    0.756
  s =~                                                                  
    y_t1              0.000                               0.000    0.000
    y_t2              1.000                               0.175    0.187
    y_t3              2.000                               0.350    0.379
    y_t4              3.000                               0.524    0.574

Covariances:
                   Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all
 .y_t1 ~~                                                               
   .y_t2              0.084    0.014    5.812    0.000    0.084    0.208
 .y_t2 ~~                                                               
   .y_t3              0.102    0.007   15.354    0.000    0.102    0.262
 .y_t3 ~~                                                               
   .y_t4              0.065    0.015    4.253    0.000    0.065    0.218
  i ~~                                                                  
    s                -0.028    0.009   -3.213    0.001   -0.228   -0.228

Intercepts:
                   Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all
    i                -0.017    0.012   -1.473    0.141   -0.025   -0.025
    s                 0.230    0.004   56.514    0.000    1.317    1.317

Variances:
                   Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all
   .y_t1              0.390    0.024   16.180    0.000    0.390    0.449
   .y_t2              0.418    0.014   29.997    0.000    0.418    0.480
   .y_t3              0.359    0.014   26.593    0.000    0.359    0.423
   .y_t4              0.248    0.025    9.774    0.000    0.248    0.297
    i                 0.478    0.025   19.414    0.000    1.000    1.000
    s                 0.031    0.005    6.415    0.000    1.000    1.000</code></pre>
</div>
</div>
</section>
<section id="interpreting-the-growth-output" class="slide level2">
<h2>Interpreting the growth output</h2>
<p>Key parameters:</p>
<ul>
<li><strong>Mean(i)</strong> = average baseline (at time score 0)</li>
<li><strong>Mean(s)</strong> = average change per time unit</li>
<li><strong>Var(i)</strong> = between-person differences in baseline</li>
<li><strong>Var(s)</strong> = between-person differences in change (heterogeneity)</li>
<li><strong>Cov(i,s)</strong> = association between intercept and slope (often negative due to artifacts: regression-to-mean, boundaries, heteroskedasticity - <strong>interpret carefully</strong>)</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a aria-hidden="true" tabindex="-1"></a><span class="fu">parameterEstimates</span>(fit_lgm) <span class="sc">|&gt;</span></span>
<span id="cb17-2"><a aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(op <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"~1"</span>,<span class="st">"~~"</span>) <span class="sc">&amp;</span> lhs <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"i"</span>,<span class="st">"s"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  lhs op rhs    est    se     z pvalue ci.lower ci.upper
1   i ~~   i  0.478 0.025 19.41  0.000    0.429    0.526
2   s ~~   s  0.031 0.005  6.42  0.000    0.021    0.040
3   i ~~   s -0.028 0.009 -3.21  0.001   -0.044   -0.011
4   i ~1     -0.017 0.012 -1.47  0.141   -0.040    0.006
5   s ~1      0.230 0.004 56.51  0.000    0.222    0.238</code></pre>
</div>
</div>
</section>
<section id="pitfallcallout-time-coding-is-a-modeling-choice" class="slide level2">
<h2>Pitfall/callout: time coding is a modeling choice</h2>
<div class="callout callout-warning callout-titled callout-style-default">
<div class="callout-body">
<div class="callout-title">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<p><strong>Warning</strong></p>
</div>
<div class="callout-content">
<p><strong>Changing time scores changes interpretation.</strong></p>
<p>If you code slope loadings as 0,1,2,3 then:</p>
<ul>
<li>intercept = expected value at wave 1</li>
</ul>
<p>If you code as -1,0,1,2 then: - intercept = expected value at wave 2</p>
<p>If you center at the midpoint, intercept becomes “midpoint status.”</p>
</div>
</div>
</div>
<p>Remember to choose a centering that matches the substantive interpretation you want.</p>
<div class="callout callout-warning callout-titled callout-style-default">
<div class="callout-body">
<div class="callout-title">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<p><strong>Warning</strong></p>
</div>
<div class="callout-content">
<p><strong>TIME POINTS MUST BE CHOSEN A PRIORI, BASED ON THEORY.</strong></p>
<p>e.g.&nbsp;Is this time point large enough to see change?</p>
</div>
</div>
</div>
</section>
<section id="a-stepwise-approach-to-lgm" class="slide level2">
<h2>A stepwise approach to LGM</h2>
<div class="{columns}">
<div class="column" style="width:65%;">
<p><img data-src="../assets/images/stepwiseLGM.png"></p>
</div><div class="column" style="width:25%;">
<p><img data-src="../assets/images/beaujean.png"></p>
</div></div>
</section>
<section class="slide level2">

</section></section>
<section>
<section id="lgm-extensions" class="title-slide slide level1 center">
<h1>LGM extensions</h1>

</section>
<section id="the-second-order-factor-model" class="slide level2">
<h2>The second-order factor model</h2>
<div style="font-size:0.5em; line-height:1.15;">
<div class="{columns}">
<div class="column" style="width:50%;">
<p><strong>The measurement block</strong></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a aria-hidden="true" tabindex="-1"></a>lgm_linear_2ndorder <span class="ot">&lt;-</span> <span class="st">'</span></span>
<span id="cb19-2"><a aria-hidden="true" tabindex="-1"></a><span class="st">## 1) MEASUREMENT (strong/scalar invariance)</span></span>
<span id="cb19-3"><a aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-4"><a aria-hidden="true" tabindex="-1"></a><span class="st"># equal loadings across time (metric invariance)</span></span>
<span id="cb19-5"><a aria-hidden="true" tabindex="-1"></a><span class="st">F1 =~ 1*y1_1 + l2*y2_1 + l3*y3_1 + l4*y4_1</span></span>
<span id="cb19-6"><a aria-hidden="true" tabindex="-1"></a><span class="st">F2 =~ 1*y1_2 + l2*y2_2 + l3*y3_2 + l4*y4_2</span></span>
<span id="cb19-7"><a aria-hidden="true" tabindex="-1"></a><span class="st">F3 =~ 1*y1_3 + l2*y2_3 + l3*y3_3 + l4*y4_3</span></span>
<span id="cb19-8"><a aria-hidden="true" tabindex="-1"></a><span class="st">F4 =~ 1*y1_4 + l2*y2_4 + l3*y3_4 + l4*y4_4</span></span>
<span id="cb19-9"><a aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-10"><a aria-hidden="true" tabindex="-1"></a><span class="st"># equal intercepts across time (scalar invariance)</span></span>
<span id="cb19-11"><a aria-hidden="true" tabindex="-1"></a><span class="st">y1_1 ~ i1*1; y1_2 ~ i1*1; y1_3 ~ i1*1; y1_4 ~ i1*1</span></span>
<span id="cb19-12"><a aria-hidden="true" tabindex="-1"></a><span class="st">y2_1 ~ i2*1; y2_2 ~ i2*1; y2_3 ~ i2*1; y2_4 ~ i2*1</span></span>
<span id="cb19-13"><a aria-hidden="true" tabindex="-1"></a><span class="st">y3_1 ~ i3*1; y3_2 ~ i3*1; y3_3 ~ i3*1; y3_4 ~ i3*1</span></span>
<span id="cb19-14"><a aria-hidden="true" tabindex="-1"></a><span class="st">y4_1 ~ i4*1; y4_2 ~ i4*1; y4_3 ~ i4*1; y4_4 ~ i4*1</span></span>
<span id="cb19-15"><a aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-16"><a aria-hidden="true" tabindex="-1"></a><span class="st"># (optional) correlated residuals across waves</span></span>
<span id="cb19-17"><a aria-hidden="true" tabindex="-1"></a><span class="st">y1_1 ~~ r1*y1_2</span></span>
<span id="cb19-18"><a aria-hidden="true" tabindex="-1"></a><span class="st">y1_2 ~~ r1*y1_3</span></span>
<span id="cb19-19"><a aria-hidden="true" tabindex="-1"></a><span class="st">y1_3 ~~ r1*y1_4</span></span>
<span id="cb19-20"><a aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-21"><a aria-hidden="true" tabindex="-1"></a><span class="st">y2_1 ~~ r2*y2_2</span></span>
<span id="cb19-22"><a aria-hidden="true" tabindex="-1"></a><span class="st">y2_2 ~~ r2*y2_3</span></span>
<span id="cb19-23"><a aria-hidden="true" tabindex="-1"></a><span class="st">y2_3 ~~ r2*y2_4</span></span>
<span id="cb19-24"><a aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-25"><a aria-hidden="true" tabindex="-1"></a><span class="st">y3_1 ~~ r3*y3_2</span></span>
<span id="cb19-26"><a aria-hidden="true" tabindex="-1"></a><span class="st">y3_2 ~~ r3*y3_3</span></span>
<span id="cb19-27"><a aria-hidden="true" tabindex="-1"></a><span class="st">y3_3 ~~ r3*y3_4</span></span>
<span id="cb19-28"><a aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-29"><a aria-hidden="true" tabindex="-1"></a><span class="st">y4_1 ~~ r4*y4_2</span></span>
<span id="cb19-30"><a aria-hidden="true" tabindex="-1"></a><span class="st">y4_2 ~~ r4*y4_3</span></span>
<span id="cb19-31"><a aria-hidden="true" tabindex="-1"></a><span class="st">y4_3 ~~ r4*y4_4</span></span>
<span id="cb19-32"><a aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-33"><a aria-hidden="true" tabindex="-1"></a><span class="st">'</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div><div class="column" style="width:50%;">
<p><strong>The latent change block</strong></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a aria-hidden="true" tabindex="-1"></a>lgm_linear_2ndorder <span class="ot">&lt;-</span> <span class="st">'</span></span>
<span id="cb20-2"><a aria-hidden="true" tabindex="-1"></a><span class="st">## 2) SECOND-ORDER GROWTH ON LATENT FACTORS</span></span>
<span id="cb20-3"><a aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-4"><a aria-hidden="true" tabindex="-1"></a><span class="st"># growth factors (second-order)</span></span>
<span id="cb20-5"><a aria-hidden="true" tabindex="-1"></a><span class="st">i =~ 1*F1 + 1*F2 + 1*F3 + 1*F4</span></span>
<span id="cb20-6"><a aria-hidden="true" tabindex="-1"></a><span class="st">s =~ 0*F1 + 1*F2 + 2*F3 + 3*F4</span></span>
<span id="cb20-7"><a aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-8"><a aria-hidden="true" tabindex="-1"></a><span class="st"># estimate growth means (trajectory in the latent metric)</span></span>
<span id="cb20-9"><a aria-hidden="true" tabindex="-1"></a><span class="st">i ~ 1</span></span>
<span id="cb20-10"><a aria-hidden="true" tabindex="-1"></a><span class="st">s ~ 1</span></span>
<span id="cb20-11"><a aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-12"><a aria-hidden="true" tabindex="-1"></a><span class="st"># fix means of the first-order factors so i/s carry the mean structure</span></span>
<span id="cb20-13"><a aria-hidden="true" tabindex="-1"></a><span class="st">F1 ~ 0*1</span></span>
<span id="cb20-14"><a aria-hidden="true" tabindex="-1"></a><span class="st">F2 ~ 0*1</span></span>
<span id="cb20-15"><a aria-hidden="true" tabindex="-1"></a><span class="st">F3 ~ 0*1</span></span>
<span id="cb20-16"><a aria-hidden="true" tabindex="-1"></a><span class="st">F4 ~ 0*1</span></span>
<span id="cb20-17"><a aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-18"><a aria-hidden="true" tabindex="-1"></a><span class="st"># (optional) allow i-s covariance</span></span>
<span id="cb20-19"><a aria-hidden="true" tabindex="-1"></a><span class="st">i ~~ s</span></span>
<span id="cb20-20"><a aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-21"><a aria-hidden="true" tabindex="-1"></a><span class="st"># (optional) residual autocorrelation among the time-specific factors</span></span>
<span id="cb20-22"><a aria-hidden="true" tabindex="-1"></a><span class="st">F1 ~~ F2</span></span>
<span id="cb20-23"><a aria-hidden="true" tabindex="-1"></a><span class="st">F2 ~~ F3</span></span>
<span id="cb20-24"><a aria-hidden="true" tabindex="-1"></a><span class="st">F3 ~~ F4</span></span>
<span id="cb20-25"><a aria-hidden="true" tabindex="-1"></a><span class="st">'</span></span>
<span id="cb20-26"><a aria-hidden="true" tabindex="-1"></a>fit_lgm_2nd <span class="ot">&lt;-</span> <span class="fu">sem</span>(lgm_linear_2ndorder, <span class="at">data =</span> dat, <span class="at">meanstructure =</span> <span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div></div>
</div>
<div class="callout callout-warning callout-titled callout-style-default">
<div class="callout-body">
<div class="callout-title">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<p><strong>Warning</strong></p>
</div>
<div class="callout-content">
<p>We are not using <code>growth()</code> here but <code>sem</code> + <code>meanstructure=TRUE</code></p>
</div>
</div>
</div>
</section>
<section id="quadratic-growth-example-simulation" class="slide level2">
<h2>Quadratic growth example (simulation)</h2>
<div style="font-size:0.5em; line-height:1.15;">
<div class="cell">
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb21-2"><a aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-3"><a aria-hidden="true" tabindex="-1"></a><span class="do">## ----------------------------</span></span>
<span id="cb21-4"><a aria-hidden="true" tabindex="-1"></a><span class="do">## 1) Population model: quadratic growth on observed variables</span></span>
<span id="cb21-5"><a aria-hidden="true" tabindex="-1"></a><span class="do">## ----------------------------</span></span>
<span id="cb21-6"><a aria-hidden="true" tabindex="-1"></a>pop_quad <span class="ot">&lt;-</span> <span class="st">'</span></span>
<span id="cb21-7"><a aria-hidden="true" tabindex="-1"></a><span class="st"># Growth factors (no first-order measurement factors; y_t* are the repeated measures)</span></span>
<span id="cb21-8"><a aria-hidden="true" tabindex="-1"></a><span class="st">i =~ 1*y_t1 + 1*y_t2 + 1*y_t3 + 1*y_t4</span></span>
<span id="cb21-9"><a aria-hidden="true" tabindex="-1"></a><span class="st">s =~ 0*y_t1 + 1*y_t2 + 2*y_t3 + 3*y_t4</span></span>
<span id="cb21-10"><a aria-hidden="true" tabindex="-1"></a><span class="st">q =~ 0*y_t1 + 1*y_t2 + 4*y_t3 + 9*y_t4</span></span>
<span id="cb21-11"><a aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-12"><a aria-hidden="true" tabindex="-1"></a><span class="st"># Factor means (imply the mean trajectory)</span></span>
<span id="cb21-13"><a aria-hidden="true" tabindex="-1"></a><span class="st">i ~ 0*1</span></span>
<span id="cb21-14"><a aria-hidden="true" tabindex="-1"></a><span class="st">s ~ 0.40*1</span></span>
<span id="cb21-15"><a aria-hidden="true" tabindex="-1"></a><span class="st">q ~ 0.15*1</span></span>
<span id="cb21-16"><a aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-17"><a aria-hidden="true" tabindex="-1"></a><span class="st"># Factor (co)variances (individual differences)</span></span>
<span id="cb21-18"><a aria-hidden="true" tabindex="-1"></a><span class="st">i ~~ 1.00*i</span></span>
<span id="cb21-19"><a aria-hidden="true" tabindex="-1"></a><span class="st">s ~~ 0.40*s</span></span>
<span id="cb21-20"><a aria-hidden="true" tabindex="-1"></a><span class="st">q ~~ 0.10*q</span></span>
<span id="cb21-21"><a aria-hidden="true" tabindex="-1"></a><span class="st">i ~~ 0.30*s</span></span>
<span id="cb21-22"><a aria-hidden="true" tabindex="-1"></a><span class="st">i ~~ 0.10*q</span></span>
<span id="cb21-23"><a aria-hidden="true" tabindex="-1"></a><span class="st">s ~~ 0.05*q</span></span>
<span id="cb21-24"><a aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-25"><a aria-hidden="true" tabindex="-1"></a><span class="st"># Fix observed intercepts so means come from i,s,q</span></span>
<span id="cb21-26"><a aria-hidden="true" tabindex="-1"></a><span class="st">y_t1 ~ 0*1</span></span>
<span id="cb21-27"><a aria-hidden="true" tabindex="-1"></a><span class="st">y_t2 ~ 0*1</span></span>
<span id="cb21-28"><a aria-hidden="true" tabindex="-1"></a><span class="st">y_t3 ~ 0*1</span></span>
<span id="cb21-29"><a aria-hidden="true" tabindex="-1"></a><span class="st">y_t4 ~ 0*1</span></span>
<span id="cb21-30"><a aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-31"><a aria-hidden="true" tabindex="-1"></a><span class="st"># Residual variances</span></span>
<span id="cb21-32"><a aria-hidden="true" tabindex="-1"></a><span class="st">y_t1 ~~ 0.64*y_t1</span></span>
<span id="cb21-33"><a aria-hidden="true" tabindex="-1"></a><span class="st">y_t2 ~~ 0.64*y_t2</span></span>
<span id="cb21-34"><a aria-hidden="true" tabindex="-1"></a><span class="st">y_t3 ~~ 0.64*y_t3</span></span>
<span id="cb21-35"><a aria-hidden="true" tabindex="-1"></a><span class="st">y_t4 ~~ 0.64*y_t4</span></span>
<span id="cb21-36"><a aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-37"><a aria-hidden="true" tabindex="-1"></a><span class="st"># Adjacent residual autocorrelation (covariances)</span></span>
<span id="cb21-38"><a aria-hidden="true" tabindex="-1"></a><span class="st">y_t1 ~~ 0.192*y_t2</span></span>
<span id="cb21-39"><a aria-hidden="true" tabindex="-1"></a><span class="st">y_t2 ~~ 0.192*y_t3</span></span>
<span id="cb21-40"><a aria-hidden="true" tabindex="-1"></a><span class="st">y_t3 ~~ 0.192*y_t4</span></span>
<span id="cb21-41"><a aria-hidden="true" tabindex="-1"></a><span class="st">'</span></span>
<span id="cb21-42"><a aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-43"><a aria-hidden="true" tabindex="-1"></a>dat <span class="ot">&lt;-</span> <span class="fu">simulateData</span>(pop_quad, <span class="at">sample.nobs =</span> <span class="dv">6000</span>, <span class="at">meanstructure =</span> <span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</section>
<section id="quadratic-results" class="slide level2">
<h2>Quadratic results</h2>
<div style="font-size:0.70em; line-height:0.75;">
<div class="{columns}">
<div class="column" style="width:50%;">
<div class="cell">
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a aria-hidden="true" tabindex="-1"></a><span class="do">## ----------------------------</span></span>
<span id="cb22-2"><a aria-hidden="true" tabindex="-1"></a><span class="do">## 2) FIT LGM without quadratic</span></span>
<span id="cb22-3"><a aria-hidden="true" tabindex="-1"></a><span class="do">## ----------------------------</span></span>
<span id="cb22-4"><a aria-hidden="true" tabindex="-1"></a>lgm_lin <span class="ot">&lt;-</span> <span class="st">'</span></span>
<span id="cb22-5"><a aria-hidden="true" tabindex="-1"></a><span class="st">i =~ 1*y_t1 + 1*y_t2 + 1*y_t3 + 1*y_t4</span></span>
<span id="cb22-6"><a aria-hidden="true" tabindex="-1"></a><span class="st">s =~ 0*y_t1 + 1*y_t2 + 2*y_t3 + 3*y_t4</span></span>
<span id="cb22-7"><a aria-hidden="true" tabindex="-1"></a><span class="st">'</span></span>
<span id="cb22-8"><a aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-9"><a aria-hidden="true" tabindex="-1"></a>fit_lin <span class="ot">&lt;-</span> <span class="fu">growth</span>(lgm_lin, <span class="at">data =</span> dat)</span>
<span id="cb22-10"><a aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-11"><a aria-hidden="true" tabindex="-1"></a><span class="fu">fitMeasures</span>(fit_lin,  <span class="fu">c</span>(<span class="st">"cfi"</span>,<span class="st">"tli"</span>,<span class="st">"rmsea"</span>,<span class="st">"srmr"</span>,<span class="st">"aic"</span>,<span class="st">"bic"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>      cfi       tli     rmsea      srmr       aic       bic 
    0.929     0.915     0.242     0.106 84653.539 84713.835 </code></pre>
</div>
</div>
</div><div class="column" style="width:50%;">
<div class="cell">
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a aria-hidden="true" tabindex="-1"></a><span class="do">## ----------------------------</span></span>
<span id="cb24-2"><a aria-hidden="true" tabindex="-1"></a><span class="do">## 3) FIT LGM with quadratic</span></span>
<span id="cb24-3"><a aria-hidden="true" tabindex="-1"></a><span class="do">## ----------------------------</span></span>
<span id="cb24-4"><a aria-hidden="true" tabindex="-1"></a>lgm_quad <span class="ot">&lt;-</span> <span class="st">'</span></span>
<span id="cb24-5"><a aria-hidden="true" tabindex="-1"></a><span class="st">i =~ 1*y_t1 + 1*y_t2 + 1*y_t3 + 1*y_t4</span></span>
<span id="cb24-6"><a aria-hidden="true" tabindex="-1"></a><span class="st">s =~ 0*y_t1 + 1*y_t2 + 2*y_t3 + 3*y_t4</span></span>
<span id="cb24-7"><a aria-hidden="true" tabindex="-1"></a><span class="st">q =~ 0*y_t1 + 1*y_t2 + 4*y_t3 + 9*y_t4</span></span>
<span id="cb24-8"><a aria-hidden="true" tabindex="-1"></a><span class="st">'</span></span>
<span id="cb24-9"><a aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-10"><a aria-hidden="true" tabindex="-1"></a>fit_quad <span class="ot">&lt;-</span> <span class="fu">growth</span>(lgm_quad, <span class="at">data =</span> dat)</span>
<span id="cb24-11"><a aria-hidden="true" tabindex="-1"></a><span class="fu">fitMeasures</span>(fit_quad, <span class="fu">c</span>(<span class="st">"cfi"</span>,<span class="st">"tli"</span>,<span class="st">"rmsea"</span>,<span class="st">"srmr"</span>,<span class="st">"aic"</span>,<span class="st">"bic"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>      cfi       tli     rmsea      srmr       aic       bic 
    1.000     1.000     0.008     0.001 82904.604 82991.697 </code></pre>
</div>
</div>
</div></div>
<div class="cell">
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a aria-hidden="true" tabindex="-1"></a><span class="fu">anova</span>(fit_lin, fit_quad)  <span class="co"># chi-square diff test (nested models)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Chi-Squared Difference Test

         Df   AIC   BIC   Chisq Chisq diff RMSEA Df diff          Pr(&gt;Chisq)
fit_quad  1 82905 82992    1.42                                             
fit_lin   5 84654 84714 1758.36       1757  0.27       4 &lt;0.0000000000000002
            
fit_quad    
fit_lin  ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
</div>
</div>
</section>
<section id="conditional-growth-predictors-of-i-and-s" class="slide level2">
<h2>Conditional growth: predictors of i and s</h2>
<p>Add a time-invariant covariate <code>x</code> predicting baseline and growth.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb28-1"><a aria-hidden="true" tabindex="-1"></a>dat<span class="sc">$</span>x <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="fu">nrow</span>(dat))  <span class="co"># example covariate</span></span>
<span id="cb28-2"><a aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-3"><a aria-hidden="true" tabindex="-1"></a>lgm_cond <span class="ot">&lt;-</span> <span class="st">'</span></span>
<span id="cb28-4"><a aria-hidden="true" tabindex="-1"></a><span class="st">i =~ 1*y_t1 + 1*y_t2 + 1*y_t3 + 1*y_t4</span></span>
<span id="cb28-5"><a aria-hidden="true" tabindex="-1"></a><span class="st">s =~ 0*y_t1 + 1*y_t2 + 2*y_t3 + 3*y_t4</span></span>
<span id="cb28-6"><a aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-7"><a aria-hidden="true" tabindex="-1"></a><span class="st"># regressions: predictors of growth factors</span></span>
<span id="cb28-8"><a aria-hidden="true" tabindex="-1"></a><span class="st">i ~ x</span></span>
<span id="cb28-9"><a aria-hidden="true" tabindex="-1"></a><span class="st">s ~ x</span></span>
<span id="cb28-10"><a aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-11"><a aria-hidden="true" tabindex="-1"></a><span class="st">y_t1 ~~ y_t2</span></span>
<span id="cb28-12"><a aria-hidden="true" tabindex="-1"></a><span class="st">y_t2 ~~ y_t3</span></span>
<span id="cb28-13"><a aria-hidden="true" tabindex="-1"></a><span class="st">y_t3 ~~ y_t4</span></span>
<span id="cb28-14"><a aria-hidden="true" tabindex="-1"></a><span class="st">'</span></span>
<span id="cb28-15"><a aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-16"><a aria-hidden="true" tabindex="-1"></a>fit_lgm_c <span class="ot">&lt;-</span> <span class="fu">growth</span>(lgm_cond, <span class="at">data =</span> dat)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="summary-of-the-conditional-model" class="slide level2">
<h2>Summary of the conditional model</h2>
<div style="font-size:0.75em; line-height:1.15;">
<div class="{columns}">
<div class="column" style="width:60%;">
<div class="cell">
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(fit_lgm_c, <span class="at">fit.measures =</span> <span class="cn">TRUE</span>, <span class="at">standardized =</span> <span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>lavaan 0.6-19 ended normally after 41 iterations

  Estimator                                         ML
  Optimization method                           NLMINB
  Number of model parameters                        14

  Number of observations                          6000

Model Test User Model:
                                                      
  Test statistic                               502.347
  Degrees of freedom                                 4
  P-value (Chi-square)                           0.000

Model Test Baseline Model:

  Test statistic                             24670.853
  Degrees of freedom                                10
  P-value                                        0.000

User Model versus Baseline Model:

  Comparative Fit Index (CFI)                    0.980
  Tucker-Lewis Index (TLI)                       0.949

Loglikelihood and Information Criteria:

  Loglikelihood user model (H0)             -41685.211
  Loglikelihood unrestricted model (H1)     -41434.038
                                                      
  Akaike (AIC)                               83398.422
  Bayesian (BIC)                             83492.216
  Sample-size adjusted Bayesian (SABIC)      83447.727

Root Mean Square Error of Approximation:

  RMSEA                                          0.144
  90 Percent confidence interval - lower         0.134
  90 Percent confidence interval - upper         0.155
  P-value H_0: RMSEA &lt;= 0.050                    0.000
  P-value H_0: RMSEA &gt;= 0.080                    1.000

Standardized Root Mean Square Residual:

  SRMR                                           0.052

Parameter Estimates:

  Standard errors                             Standard
  Information                                 Expected
  Information saturated (h1) model          Structured

Latent Variables:
                   Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all
  i =~                                                                  
    y_t1              1.000                               0.542    0.420
    y_t2              1.000                               0.542    0.315
    y_t3              1.000                               0.542    0.197
    y_t4              1.000                               0.542    0.121
  s =~                                                                  
    y_t1              0.000                               0.000    0.000
    y_t2              1.000                               0.832    0.483
    y_t3              2.000                               1.664    0.605
    y_t4              3.000                               2.496    0.557

Regressions:
                   Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all
  i ~                                                                   
    x                -0.012    0.016   -0.775    0.438   -0.022   -0.022
  s ~                                                                   
    x                 0.030    0.014    2.138    0.033    0.036    0.036

Covariances:
                   Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all
 .y_t1 ~~                                                               
   .y_t2              0.416    0.028   14.784    0.000    0.416    0.688
 .y_t2 ~~                                                               
   .y_t3             -0.248    0.020  -12.374    0.000   -0.248   -0.465
 .y_t3 ~~                                                               
   .y_t4              2.814    0.104   27.025    0.000    2.814    0.935
 .i ~~                                                                  
   .s                 0.857    0.037   22.944    0.000    1.900    1.900

Intercepts:
                   Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all
   .i                -0.141    0.016   -9.050    0.000   -0.259   -0.259
   .s                 0.630    0.014   44.449    0.000    0.757    0.757

Variances:
                   Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all
   .y_t1              1.373    0.058   23.604    0.000    1.373    0.823
   .y_t2              0.266    0.027    9.840    0.000    0.266    0.090
   .y_t3              1.073    0.065   16.476    0.000    1.073    0.142
   .y_t4              8.445    0.223   37.805    0.000    8.445    0.420
   .i                 0.294    0.053    5.575    0.000    1.000    1.000
   .s                 0.692    0.028   24.380    0.000    0.999    0.999</code></pre>
</div>
</div>
</div><div class="column" style="width:40%;">
<div class="callout callout-warning callout-titled callout-style-default">
<div class="callout-body">
<div class="callout-title">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<p><strong>Warning</strong></p>
</div>
<div class="callout-content">
<p>As for <span class="math inline">\(i\)</span> ~~ <span class="math inline">\(s\)</span> correlations, when an external variable is associated with the intercept, it will probably be associated with the slope, but this is often an artifact. A second-order model could help resolving this issue and avoid issues due to bounds in measures.</p>
</div>
</div>
</div>
</div></div>
</div>
</section>
<section id="local-diagnostics-for-growth-models" class="slide level2">
<h2>Local diagnostics for growth models</h2>
<p>Global fit is necessary but not sufficient.</p>
<ul>
<li>residual autocorrelation (y_t2 ~~ y_t3, etc.)</li>
<li>MIs suggesting additional residual correlations</li>
<li>implausible negative variances (Heywood)</li>
<li>standardized residuals / fitted vs observed means</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb31-1"><a aria-hidden="true" tabindex="-1"></a>mi_g <span class="ot">&lt;-</span> <span class="fu">modificationIndices</span>(fit_quad)</span>
<span id="cb31-2"><a aria-hidden="true" tabindex="-1"></a>mi_g <span class="sc">|&gt;</span> <span class="fu">arrange</span>(<span class="fu">desc</span>(mi)) <span class="sc">|&gt;</span> <span class="fu">head</span>(<span class="dv">10</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>    lhs op  rhs   mi    epc sepc.lv sepc.all sepc.nox
1     i =~ y_t4 1.42  4.525   5.596    1.267    1.267
2     i =~ y_t3 1.42 -1.508  -1.865   -0.682   -0.682
3     i =~ y_t2 1.42  1.508   1.865    1.084    1.084
4     s =~ y_t1 1.42  0.099   0.108    0.084    0.084
5  y_t2 ~1      1.42 -0.014  -0.014   -0.008   -0.008
6     s =~ y_t2 1.42 -0.033  -0.036   -0.021   -0.021
7  y_t1 ~1      1.42  0.041   0.041    0.032    0.032
8     q =~ y_t4 1.42 -0.281  -0.121   -0.027   -0.027
9     q =~ y_t1 1.42  0.281   0.121    0.094    0.094
10 y_t3 ~1      1.42  0.014   0.014    0.005    0.005</code></pre>
</div>
</div>
</section>
<section id="what-we-did-not-do-on-purpose" class="slide level2">
<h2>What we did NOT do (on purpose)</h2>
<ul>
<li><p>RI-CLPM and LCS families (they answer different questions)</p>
<p>→ <strong>RI-CLPM warnings &amp; alternatives:</strong> <code>slides/opt05_riclpm_warning-and-alternatives.qmd</code> (and/or <code>extras/ex06_riclpm_vs_clpm.qmd</code>) → <strong>Latent change score models:</strong> <code>extras/ex07_latent-change-score_models.qmd</code></p></li>
</ul>
</section>
<section id="exercises-lab09-explicit-links" class="slide level2">
<h2>Exercises → Lab09 (explicit links)</h2>
<p>In <strong>Lab09 (longitudinal growth)</strong> you will:</p>
<ol type="1">
<li><strong>Longitudinal invariance ladder</strong>
<ul>
<li>Fit configural → metric → scalar</li>
<li>Decide if partial scalar is needed (and document what you free)</li>
</ul></li>
<li><strong>Fit linear LGM</strong> (time scores 0,1,2,3)
<ul>
<li>Interpret mean/variance of intercept and slope</li>
<li>Re-center time to change intercept meaning</li>
</ul></li>
<li><strong>Add curvature or residual autocorrelation</strong>
<ul>
<li>Compare fit + interpretability (don’t respecify blindly)</li>
</ul></li>
<li><strong>Conditional growth</strong>
<ul>
<li>Add a predictor of intercept and slope; interpret effects</li>
</ul></li>
</ol>
</section>
<section id="take-home-summary-3-things" class="slide level2">
<h2>Take-home summary: 3 things</h2>
<ol type="1">
<li><strong>Measurement invariance over time is the entry ticket</strong> to interpreting mean change.</li>
<li><strong>Growth models are SEMs</strong> with time-coded loadings: interpretation depends on time coding/centering.</li>
<li><strong>Diagnostics matter:</strong> combine global fit with local checks; respecify with theory and transparency.</li>
</ol>
</section>
<section id="references" class="slide level2">
<h2>References</h2>
<p>(Generated from <code>refs/references.bib</code> using APA 7 CSL.)</p>


</section></section>
    </div>
  <div class="quarto-auto-generated-content" style="display: none;">
<div class="footer footer-default">

</div>
</div></div>

  <script>window.backupDefine = window.define; window.define = undefined;</script>
  <script src="../site_libs/revealjs/dist/reveal.js"></script>
  <!-- reveal.js plugins -->
  <script src="../site_libs/revealjs/plugin/quarto-line-highlight/line-highlight.js"></script>
  <script src="../site_libs/revealjs/plugin/pdf-export/pdfexport.js"></script>
  <script src="../site_libs/revealjs/plugin/reveal-menu/menu.js"></script>
  <script src="../site_libs/revealjs/plugin/reveal-menu/quarto-menu.js"></script>
  <script src="../site_libs/revealjs/plugin/quarto-support/support.js"></script>
  

  <script src="../site_libs/revealjs/plugin/notes/notes.js"></script>
  <script src="../site_libs/revealjs/plugin/search/search.js"></script>
  <script src="../site_libs/revealjs/plugin/zoom/zoom.js"></script>
  <script src="../site_libs/revealjs/plugin/math/math.js"></script>
  <script>window.define = window.backupDefine; window.backupDefine = undefined;</script>

  <script>

      // Full list of configuration options available at:
      // https://revealjs.com/config/
      Reveal.initialize({
'controlsAuto': true,
'previewLinksAuto': false,
'pdfSeparateFragments': false,
'autoAnimateEasing': "ease",
'autoAnimateDuration': 1,
'autoAnimateUnmatched': true,
'jumpToSlide': true,
'menu': {"side":"left","useTextContentForMissingTitles":true,"markers":false,"loadIcons":false,"custom":[{"title":"Tools","icon":"<i class=\"fas fa-gear\"></i>","content":"<ul class=\"slide-menu-items\">\n<li class=\"slide-tool-item active\" data-item=\"0\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.fullscreen(event)\"><kbd>f</kbd> Fullscreen</a></li>\n<li class=\"slide-tool-item\" data-item=\"1\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.speakerMode(event)\"><kbd>s</kbd> Speaker View</a></li>\n<li class=\"slide-tool-item\" data-item=\"2\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.overview(event)\"><kbd>o</kbd> Slide Overview</a></li>\n<li class=\"slide-tool-item\" data-item=\"3\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.togglePdfExport(event)\"><kbd>e</kbd> PDF Export Mode</a></li>\n<li class=\"slide-tool-item\" data-item=\"4\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.toggleScrollView(event)\"><kbd>r</kbd> Scroll View Mode</a></li>\n<li class=\"slide-tool-item\" data-item=\"5\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.keyboardHelp(event)\"><kbd>?</kbd> Keyboard Help</a></li>\n</ul>"}],"openButton":true},
'smaller': false,
 
        // Display controls in the bottom right corner
        controls: false,

        // Help the user learn the controls by providing hints, for example by
        // bouncing the down arrow when they first encounter a vertical slide
        controlsTutorial: false,

        // Determines where controls appear, "edges" or "bottom-right"
        controlsLayout: 'edges',

        // Visibility rule for backwards navigation arrows; "faded", "hidden"
        // or "visible"
        controlsBackArrows: 'faded',

        // Display a presentation progress bar
        progress: true,

        // Display the page number of the current slide
        slideNumber: 'c/t',

        // 'all', 'print', or 'speaker'
        showSlideNumber: 'all',

        // Add the current slide number to the URL hash so that reloading the
        // page/copying the URL will return you to the same slide
        hash: true,

        // Start with 1 for the hash rather than 0
        hashOneBasedIndex: false,

        // Flags if we should monitor the hash and change slides accordingly
        respondToHashChanges: true,

        // Push each slide change to the browser history
        history: true,

        // Enable keyboard shortcuts for navigation
        keyboard: true,

        // Enable the slide overview mode
        overview: true,

        // Disables the default reveal.js slide layout (scaling and centering)
        // so that you can use custom CSS layout
        disableLayout: false,

        // Vertical centering of slides
        center: false,

        // Enables touch navigation on devices with touch input
        touch: true,

        // Loop the presentation
        loop: false,

        // Change the presentation direction to be RTL
        rtl: false,

        // see https://revealjs.com/vertical-slides/#navigation-mode
        navigationMode: 'linear',

        // Randomizes the order of slides each time the presentation loads
        shuffle: false,

        // Turns fragments on and off globally
        fragments: true,

        // Flags whether to include the current fragment in the URL,
        // so that reloading brings you to the same fragment position
        fragmentInURL: false,

        // Flags if the presentation is running in an embedded mode,
        // i.e. contained within a limited portion of the screen
        embedded: false,

        // Flags if we should show a help overlay when the questionmark
        // key is pressed
        help: true,

        // Flags if it should be possible to pause the presentation (blackout)
        pause: true,

        // Flags if speaker notes should be visible to all viewers
        showNotes: false,

        // Global override for autoplaying embedded media (null/true/false)
        autoPlayMedia: null,

        // Global override for preloading lazy-loaded iframes (null/true/false)
        preloadIframes: null,

        // Number of milliseconds between automatically proceeding to the
        // next slide, disabled when set to 0, this value can be overwritten
        // by using a data-autoslide attribute on your slides
        autoSlide: 0,

        // Stop auto-sliding after user input
        autoSlideStoppable: true,

        // Use this method for navigation when auto-sliding
        autoSlideMethod: null,

        // Specify the average time in seconds that you think you will spend
        // presenting each slide. This is used to show a pacing timer in the
        // speaker view
        defaultTiming: null,

        // Enable slide navigation via mouse wheel
        mouseWheel: false,

        // The display mode that will be used to show slides
        display: 'block',

        // Hide cursor if inactive
        hideInactiveCursor: true,

        // Time before the cursor is hidden (in ms)
        hideCursorTime: 5000,

        // Opens links in an iframe preview overlay
        previewLinks: false,

        // Transition style (none/fade/slide/convex/concave/zoom)
        transition: 'none',

        // Transition speed (default/fast/slow)
        transitionSpeed: 'default',

        // Transition style for full page slide backgrounds
        // (none/fade/slide/convex/concave/zoom)
        backgroundTransition: 'none',

        // Number of slides away from the current that are visible
        viewDistance: 3,

        // Number of slides away from the current that are visible on mobile
        // devices. It is advisable to set this to a lower number than
        // viewDistance in order to save resources.
        mobileViewDistance: 2,

        // The "normal" size of the presentation, aspect ratio will be preserved
        // when the presentation is scaled to fit different resolutions. Can be
        // specified using percentage units.
        width: 1050,

        height: 700,

        // Factor of the display size that should remain empty around the content
        margin: 0.1,

        math: {
          mathjax: 'https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/MathJax.js',
          config: 'TeX-AMS_HTML-full',
          tex2jax: {
            inlineMath: [['\\(','\\)']],
            displayMath: [['\\[','\\]']],
            balanceBraces: true,
            processEscapes: false,
            processRefs: true,
            processEnvironments: true,
            preview: 'TeX',
            skipTags: ['script','noscript','style','textarea','pre','code'],
            ignoreClass: 'tex2jax_ignore',
            processClass: 'tex2jax_process'
          },
        },

        // reveal.js plugins
        plugins: [QuartoLineHighlight, PdfExport, RevealMenu, QuartoSupport,

          RevealMath,
          RevealNotes,
          RevealSearch,
          RevealZoom
        ]
      });
    </script>
    

    <script>

      // htmlwidgets need to know to resize themselves when slides are shown/hidden.

      // Fire the "slideenter" event (handled by htmlwidgets.js) when the current

      // slide changes (different for each slide format).

      (function () {

        // dispatch for htmlwidgets

        function fireSlideEnter() {

          const event = window.document.createEvent("Event");

          event.initEvent("slideenter", true, true);

          window.document.dispatchEvent(event);

        }

    

        function fireSlideChanged(previousSlide, currentSlide) {

          fireSlideEnter();

    

          // dispatch for shiny

          if (window.jQuery) {

            if (previousSlide) {

              window.jQuery(previousSlide).trigger("hidden");

            }

            if (currentSlide) {

              window.jQuery(currentSlide).trigger("shown");

            }

          }

        }

    

        // hookup for slidy

        if (window.w3c_slidy) {

          window.w3c_slidy.add_observer(function (slide_num) {

            // slide_num starts at position 1

            fireSlideChanged(null, w3c_slidy.slides[slide_num - 1]);

          });

        }

    

      })();

    </script>

    

    <script id="quarto-html-after-body" type="application/javascript">
      window.document.addEventListener("DOMContentLoaded", function (event) {
        const tabsets =  window.document.querySelectorAll(".panel-tabset-tabby")
        tabsets.forEach(function(tabset) {
          const tabby = new Tabby('#' + tabset.id);
        });
        const isCodeAnnotation = (el) => {
          for (const clz of el.classList) {
            if (clz.startsWith('code-annotation-')) {                     
              return true;
            }
          }
          return false;
        }
        const onCopySuccess = function(e) {
          // button target
          const button = e.trigger;
          // don't keep focus
          button.blur();
          // flash "checked"
          button.classList.add('code-copy-button-checked');
          var currentTitle = button.getAttribute("title");
          button.setAttribute("title", "Copied!");
          let tooltip;
          if (window.bootstrap) {
            button.setAttribute("data-bs-toggle", "tooltip");
            button.setAttribute("data-bs-placement", "left");
            button.setAttribute("data-bs-title", "Copied!");
            tooltip = new bootstrap.Tooltip(button, 
              { trigger: "manual", 
                customClass: "code-copy-button-tooltip",
                offset: [0, -8]});
            tooltip.show();    
          }
          setTimeout(function() {
            if (tooltip) {
              tooltip.hide();
              button.removeAttribute("data-bs-title");
              button.removeAttribute("data-bs-toggle");
              button.removeAttribute("data-bs-placement");
            }
            button.setAttribute("title", currentTitle);
            button.classList.remove('code-copy-button-checked');
          }, 1000);
          // clear code selection
          e.clearSelection();
        }
        const getTextToCopy = function(trigger) {
            const codeEl = trigger.previousElementSibling.cloneNode(true);
            for (const childEl of codeEl.children) {
              if (isCodeAnnotation(childEl)) {
                childEl.remove();
              }
            }
            return codeEl.innerText;
        }
        const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
          text: getTextToCopy
        });
        clipboard.on('success', onCopySuccess);
        if (window.document.getElementById('quarto-embedded-source-code-modal')) {
          const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
            text: getTextToCopy,
            container: window.document.getElementById('quarto-embedded-source-code-modal')
          });
          clipboardModal.on('success', onCopySuccess);
        }
          var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
          var mailtoRegex = new RegExp(/^mailto:/);
            var filterRegex = new RegExp('/' + window.location.host + '/');
          var isInternal = (href) => {
              return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
          }
          // Inspect non-navigation links and adorn them if external
         var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
          for (var i=0; i<links.length; i++) {
            const link = links[i];
            if (!isInternal(link.href)) {
              // undo the damage that might have been done by quarto-nav.js in the case of
              // links that we want to consider external
              if (link.dataset.originalHref !== undefined) {
                link.href = link.dataset.originalHref;
              }
            }
          }
        function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
          const config = {
            allowHTML: true,
            maxWidth: 500,
            delay: 100,
            arrow: false,
            appendTo: function(el) {
                return el.closest('section.slide') || el.parentElement;
            },
            interactive: true,
            interactiveBorder: 10,
            theme: 'light-border',
            placement: 'bottom-start',
          };
          if (contentFn) {
            config.content = contentFn;
          }
          if (onTriggerFn) {
            config.onTrigger = onTriggerFn;
          }
          if (onUntriggerFn) {
            config.onUntrigger = onUntriggerFn;
          }
            config['offset'] = [0,0];
            config['maxWidth'] = 700;
          window.tippy(el, config); 
        }
        const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
        for (var i=0; i<noterefs.length; i++) {
          const ref = noterefs[i];
          tippyHover(ref, function() {
            // use id or data attribute instead here
            let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
            try { href = new URL(href).hash; } catch {}
            const id = href.replace(/^#\/?/, "");
            const note = window.document.getElementById(id);
            if (note) {
              return note.innerHTML;
            } else {
              return "";
            }
          });
        }
        const findCites = (el) => {
          const parentEl = el.parentElement;
          if (parentEl) {
            const cites = parentEl.dataset.cites;
            if (cites) {
              return {
                el,
                cites: cites.split(' ')
              };
            } else {
              return findCites(el.parentElement)
            }
          } else {
            return undefined;
          }
        };
        var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
        for (var i=0; i<bibliorefs.length; i++) {
          const ref = bibliorefs[i];
          const citeInfo = findCites(ref);
          if (citeInfo) {
            tippyHover(citeInfo.el, function() {
              var popup = window.document.createElement('div');
              citeInfo.cites.forEach(function(cite) {
                var citeDiv = window.document.createElement('div');
                citeDiv.classList.add('hanging-indent');
                citeDiv.classList.add('csl-entry');
                var biblioDiv = window.document.getElementById('ref-' + cite);
                if (biblioDiv) {
                  citeDiv.innerHTML = biblioDiv.innerHTML;
                }
                popup.appendChild(citeDiv);
              });
              return popup.innerHTML;
            });
          }
        }
      });
      </script>
    

</body></html>