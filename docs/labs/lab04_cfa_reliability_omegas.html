<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.7.32">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Tommaso Feraco">

<title>Lab 04 — CFA: measurement, local misfit, and ω reliability – SEM-PhD</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
html { -webkit-text-size-adjust: 100%; }
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../site_libs/clipboard/clipboard.min.js"></script>
<script src="../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../site_libs/quarto-search/fuse.min.js"></script>
<script src="../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../">
<script src="../site_libs/quarto-html/quarto.js" type="module"></script>
<script src="../site_libs/quarto-html/tabsets/tabsets.js" type="module"></script>
<script src="../site_libs/quarto-html/popper.min.js"></script>
<script src="../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../site_libs/quarto-html/anchor.min.js"></script>
<link href="../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting-37eea08aefeeee20ff55810ff984fec1.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../site_libs/bootstrap/bootstrap-69548dc370d8aa5186370da619938e85.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>


</head>

<body class="nav-fixed quarto-light">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a class="navbar-brand" href="../index.html">
    <span class="navbar-title">SEM-PhD</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" role="menu" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item">
    <a class="nav-link" href="../index.html"> 
<span class="menu-text">Home</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../setup.html"> 
<span class="menu-text">Setup</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../slides/slides_index.html"> 
<span class="menu-text">Slides</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../labs/labs_index.html"> 
<span class="menu-text">Labs</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../glossary.html"> 
<span class="menu-text">Glossary</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../reporting-checklist.html"> 
<span class="menu-text">Reporting checklist</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../extras/extras_index.html"> 
<span class="menu-text">Extras</span></a>
  </li>  
</ul>
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item compact">
    <a class="nav-link" href="https://github.com/feracotommaso/SEM-phd-course"> <i class="bi bi-github" role="img">
</i> 
<span class="menu-text"></span></a>
  </li>  
</ul>
          </div> <!-- /navcollapse -->
            <div class="quarto-navbar-tools">
</div>
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#goals" id="toc-goals" class="nav-link active" data-scroll-target="#goals">Goals</a></li>
  <li><a href="#setup" id="toc-setup" class="nav-link" data-scroll-target="#setup">Setup</a></li>
  <li><a href="#part-a-competing-measurement-hypotheses" id="toc-part-a-competing-measurement-hypotheses" class="nav-link" data-scroll-target="#part-a-competing-measurement-hypotheses">Part A — Competing measurement hypotheses</a>
  <ul class="collapse">
  <li><a href="#model-1-one-general-factor" id="toc-model-1-one-general-factor" class="nav-link" data-scroll-target="#model-1-one-general-factor">Model 1: One general factor</a></li>
  <li><a href="#model-2-three-correlated-factors-the-classic-hs-structure" id="toc-model-2-three-correlated-factors-the-classic-hs-structure" class="nav-link" data-scroll-target="#model-2-three-correlated-factors-the-classic-hs-structure">Model 2: Three correlated factors (the classic HS structure)</a></li>
  </ul></li>
  <li><a href="#exercise-1-compare-the-two-models" id="toc-exercise-1-compare-the-two-models" class="nav-link" data-scroll-target="#exercise-1-compare-the-two-models">Exercise 1 — Compare the two models</a>
  <ul class="collapse">
  <li><a href="#a-compare-global-fit" id="toc-a-compare-global-fit" class="nav-link" data-scroll-target="#a-compare-global-fit">1a) Compare global fit</a></li>
  <li><a href="#b-compare-with-a-χ²-difference-test-nested" id="toc-b-compare-with-a-χ²-difference-test-nested" class="nav-link" data-scroll-target="#b-compare-with-a-χ²-difference-test-nested">1b) Compare with a χ² difference test (nested?)</a></li>
  </ul></li>
  <li><a href="#part-b-interpret-key-parameters-measurement-level-thinking" id="toc-part-b-interpret-key-parameters-measurement-level-thinking" class="nav-link" data-scroll-target="#part-b-interpret-key-parameters-measurement-level-thinking">Part B — Interpret key parameters (measurement-level thinking)</a></li>
  <li><a href="#exercise-2-loadings-residual-variances-and-factor-correlations" id="toc-exercise-2-loadings-residual-variances-and-factor-correlations" class="nav-link" data-scroll-target="#exercise-2-loadings-residual-variances-and-factor-correlations">Exercise 2 — Loadings, residual variances, and factor correlations</a>
  <ul class="collapse">
  <li><a href="#a-standardized-loadings" id="toc-a-standardized-loadings" class="nav-link" data-scroll-target="#a-standardized-loadings">2a) Standardized loadings</a></li>
  <li><a href="#b-residual-variances" id="toc-b-residual-variances" class="nav-link" data-scroll-target="#b-residual-variances">2b) Residual variances</a></li>
  <li><a href="#c-factor-correlations" id="toc-c-factor-correlations" class="nav-link" data-scroll-target="#c-factor-correlations">2c) Factor correlations</a></li>
  </ul></li>
  <li><a href="#part-c-local-misfit-residual-correlations-and-mi-cfa-specific" id="toc-part-c-local-misfit-residual-correlations-and-mi-cfa-specific" class="nav-link" data-scroll-target="#part-c-local-misfit-residual-correlations-and-mi-cfa-specific">Part C — Local misfit: residual correlations and MI (CFA-specific)</a></li>
  <li><a href="#exercise-3-residual-correlations-where-does-the-model-fail" id="toc-exercise-3-residual-correlations-where-does-the-model-fail" class="nav-link" data-scroll-target="#exercise-3-residual-correlations-where-does-the-model-fail">Exercise 3 — Residual correlations (where does the model fail?)</a></li>
  <li><a href="#exercise-4-mi-epcsepc-use-with-a-theory-filter" id="toc-exercise-4-mi-epcsepc-use-with-a-theory-filter" class="nav-link" data-scroll-target="#exercise-4-mi-epcsepc-use-with-a-theory-filter">Exercise 4 — MI + EPC/SEPC (use with a theory filter)</a></li>
  <li><a href="#exercise-5-respecify-one-change-refit-document" id="toc-exercise-5-respecify-one-change-refit-document" class="nav-link" data-scroll-target="#exercise-5-respecify-one-change-refit-document">Exercise 5 — Respecify (one change), refit, document</a></li>
  <li><a href="#part-d-reliability-from-cfa-ω-family" id="toc-part-d-reliability-from-cfa-ω-family" class="nav-link" data-scroll-target="#part-d-reliability-from-cfa-ω-family">Part D — Reliability from CFA (ω family)</a></li>
  <li><a href="#exercise-6-compute-ω-reliability" id="toc-exercise-6-compute-ω-reliability" class="nav-link" data-scroll-target="#exercise-6-compute-ω-reliability">Exercise 6 — Compute ω reliability</a></li>
  <li><a href="#optional-part-e-bifactor-model-advanced" id="toc-optional-part-e-bifactor-model-advanced" class="nav-link" data-scroll-target="#optional-part-e-bifactor-model-advanced">Optional Part E — Bifactor model (advanced)</a></li>
  <li><a href="#wrap-up" id="toc-wrap-up" class="nav-link" data-scroll-target="#wrap-up">Wrap-up</a>
  <ul class="collapse">
  <li><a href="#take-home" id="toc-take-home" class="nav-link" data-scroll-target="#take-home">Take-home</a></li>
  </ul></li>
  <li><a href="#solutions-instructor-version" id="toc-solutions-instructor-version" class="nav-link" data-scroll-target="#solutions-instructor-version">Solutions (instructor version)</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Lab 04 — CFA: measurement, local misfit, and ω reliability</h1>
</div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>Tommaso Feraco </p>
          </div>
  </div>
    
  
    
  </div>
  


</header>


<section id="goals" class="level1">
<h1>Goals</h1>
<p>In this lab you will:</p>
<ul>
<li>Fit and compare CFA models (1-factor vs correlated factors)</li>
<li>Inspect <strong>local misfit</strong> for CFA (residual correlations, MI + EPC/SEPC)</li>
<li>Make <strong>theory-filtered</strong> respecification choices (and document them)</li>
<li>Compute and report <strong>reliability from CFA</strong> (ω family via <code>semTools</code>)</li>
<li>(Optional) Fit a <strong>bifactor</strong> model and evaluate interpretability (not just fit)</li>
</ul>
<hr>
</section>
<section id="setup" class="level1">
<h1>Setup</h1>
<div class="cell">
<details class="code-fold">
<summary>Show code</summary>
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(lavaan)</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(semTools)</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(semPlot)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>We’ll use the built-in dataset <code>HolzingerSwineford1939</code> (9 tests; classic CFA example).</p>
<div class="cell">
<details class="code-fold">
<summary>Show code</summary>
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>dat <span class="ot">&lt;-</span> HolzingerSwineford1939</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>vars <span class="ot">&lt;-</span> <span class="fu">paste0</span>(<span class="st">"x"</span>, <span class="dv">1</span><span class="sc">:</span><span class="dv">9</span>)</span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a>dat <span class="ot">&lt;-</span> dat[, vars]</span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(dat)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>       x1              x2             x3             x4             x5      
 Min.   :0.667   Min.   :2.25   Min.   :0.25   Min.   :0.00   Min.   :1.00  
 1st Qu.:4.167   1st Qu.:5.25   1st Qu.:1.38   1st Qu.:2.33   1st Qu.:3.50  
 Median :5.000   Median :6.00   Median :2.12   Median :3.00   Median :4.50  
 Mean   :4.936   Mean   :6.09   Mean   :2.25   Mean   :3.06   Mean   :4.34  
 3rd Qu.:5.667   3rd Qu.:6.75   3rd Qu.:3.12   3rd Qu.:3.67   3rd Qu.:5.25  
 Max.   :8.500   Max.   :9.25   Max.   :4.50   Max.   :6.33   Max.   :7.00  
       x6              x7             x8              x9      
 Min.   :0.143   Min.   :1.30   Min.   : 3.05   Min.   :2.78  
 1st Qu.:1.429   1st Qu.:3.48   1st Qu.: 4.85   1st Qu.:4.75  
 Median :2.000   Median :4.09   Median : 5.50   Median :5.42  
 Mean   :2.186   Mean   :4.19   Mean   : 5.53   Mean   :5.37  
 3rd Qu.:2.714   3rd Qu.:4.91   3rd Qu.: 6.10   3rd Qu.:6.08  
 Max.   :6.143   Max.   :7.43   Max.   :10.00   Max.   :9.25  </code></pre>
</div>
</div>
<hr>
</section>
<section id="part-a-competing-measurement-hypotheses" class="level1">
<h1>Part A — Competing measurement hypotheses</h1>
<section id="model-1-one-general-factor" class="level2">
<h2 class="anchored" data-anchor-id="model-1-one-general-factor">Model 1: One general factor</h2>
<div class="cell">
<details class="code-fold">
<summary>Show code</summary>
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>m1 <span class="ot">&lt;-</span> <span class="st">'</span></span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a><span class="st">  g =~ x1 + x2 + x3 + x4 + x5 + x6 + x7 + x8 + x9</span></span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a><span class="st">'</span></span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a>fit1 <span class="ot">&lt;-</span> <span class="fu">cfa</span>(m1, <span class="at">data =</span> dat, <span class="at">std.lv =</span> <span class="cn">TRUE</span>)</span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(fit1, <span class="at">fit.measures =</span> <span class="cn">TRUE</span>, <span class="at">standardized =</span> <span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>lavaan 0.6-19 ended normally after 18 iterations

  Estimator                                         ML
  Optimization method                           NLMINB
  Number of model parameters                        18

  Number of observations                           301

Model Test User Model:
                                                      
  Test statistic                               312.264
  Degrees of freedom                                27
  P-value (Chi-square)                           0.000

Model Test Baseline Model:

  Test statistic                               918.852
  Degrees of freedom                                36
  P-value                                        0.000

User Model versus Baseline Model:

  Comparative Fit Index (CFI)                    0.677
  Tucker-Lewis Index (TLI)                       0.569

Loglikelihood and Information Criteria:

  Loglikelihood user model (H0)              -3851.224
  Loglikelihood unrestricted model (H1)      -3695.092
                                                      
  Akaike (AIC)                                7738.448
  Bayesian (BIC)                              7805.176
  Sample-size adjusted Bayesian (SABIC)       7748.091

Root Mean Square Error of Approximation:

  RMSEA                                          0.187
  90 Percent confidence interval - lower         0.169
  90 Percent confidence interval - upper         0.206
  P-value H_0: RMSEA &lt;= 0.050                    0.000
  P-value H_0: RMSEA &gt;= 0.080                    1.000

Standardized Root Mean Square Residual:

  SRMR                                           0.143

Parameter Estimates:

  Standard errors                             Standard
  Information                                 Expected
  Information saturated (h1) model          Structured

Latent Variables:
                   Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all
  g =~                                                                  
    x1                0.510    0.068    7.550    0.000    0.510    0.438
    x2                0.259    0.071    3.649    0.000    0.259    0.220
    x3                0.252    0.068    3.689    0.000    0.252    0.223
    x4                0.985    0.057   17.375    0.000    0.985    0.848
    x5                1.084    0.063   17.181    0.000    1.084    0.841
    x6                0.917    0.054   17.092    0.000    0.917    0.838
    x7                0.196    0.066    2.975    0.003    0.196    0.180
    x8                0.203    0.061    3.323    0.001    0.203    0.201
    x9                0.309    0.060    5.143    0.000    0.309    0.307

Variances:
                   Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all
   .x1                1.098    0.092   11.895    0.000    1.098    0.808
   .x2                1.315    0.108   12.188    0.000    1.315    0.951
   .x3                1.212    0.099   12.186    0.000    1.212    0.950
   .x4                0.380    0.048    7.963    0.000    0.380    0.281
   .x5                0.486    0.059    8.193    0.000    0.486    0.293
   .x6                0.356    0.043    8.295    0.000    0.356    0.298
   .x7                1.145    0.094   12.215    0.000    1.145    0.967
   .x8                0.981    0.080   12.202    0.000    0.981    0.960
   .x9                0.919    0.076   12.105    0.000    0.919    0.906
    g                 1.000                               1.000    1.000</code></pre>
</div>
</div>
</section>
<section id="model-2-three-correlated-factors-the-classic-hs-structure" class="level2">
<h2 class="anchored" data-anchor-id="model-2-three-correlated-factors-the-classic-hs-structure">Model 2: Three correlated factors (the classic HS structure)</h2>
<div class="cell">
<details class="code-fold">
<summary>Show code</summary>
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>m3 <span class="ot">&lt;-</span> <span class="st">'</span></span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a><span class="st">  visual  =~ x1 + x2 + x3</span></span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a><span class="st">  textual =~ x4 + x5 + x6</span></span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a><span class="st">  speed   =~ x7 + x8 + x9</span></span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a><span class="st">'</span></span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a>fit3 <span class="ot">&lt;-</span> <span class="fu">cfa</span>(m3, <span class="at">data =</span> dat, <span class="at">std.lv =</span> <span class="cn">TRUE</span>)</span>
<span id="cb6-7"><a href="#cb6-7" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(fit3, <span class="at">fit.measures =</span> <span class="cn">TRUE</span>, <span class="at">standardized =</span> <span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>lavaan 0.6-19 ended normally after 20 iterations

  Estimator                                         ML
  Optimization method                           NLMINB
  Number of model parameters                        21

  Number of observations                           301

Model Test User Model:
                                                      
  Test statistic                                85.306
  Degrees of freedom                                24
  P-value (Chi-square)                           0.000

Model Test Baseline Model:

  Test statistic                               918.852
  Degrees of freedom                                36
  P-value                                        0.000

User Model versus Baseline Model:

  Comparative Fit Index (CFI)                    0.931
  Tucker-Lewis Index (TLI)                       0.896

Loglikelihood and Information Criteria:

  Loglikelihood user model (H0)              -3737.745
  Loglikelihood unrestricted model (H1)      -3695.092
                                                      
  Akaike (AIC)                                7517.490
  Bayesian (BIC)                              7595.339
  Sample-size adjusted Bayesian (SABIC)       7528.739

Root Mean Square Error of Approximation:

  RMSEA                                          0.092
  90 Percent confidence interval - lower         0.071
  90 Percent confidence interval - upper         0.114
  P-value H_0: RMSEA &lt;= 0.050                    0.001
  P-value H_0: RMSEA &gt;= 0.080                    0.840

Standardized Root Mean Square Residual:

  SRMR                                           0.065

Parameter Estimates:

  Standard errors                             Standard
  Information                                 Expected
  Information saturated (h1) model          Structured

Latent Variables:
                   Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all
  visual =~                                                             
    x1                0.900    0.081   11.128    0.000    0.900    0.772
    x2                0.498    0.077    6.429    0.000    0.498    0.424
    x3                0.656    0.074    8.817    0.000    0.656    0.581
  textual =~                                                            
    x4                0.990    0.057   17.474    0.000    0.990    0.852
    x5                1.102    0.063   17.576    0.000    1.102    0.855
    x6                0.917    0.054   17.082    0.000    0.917    0.838
  speed =~                                                              
    x7                0.619    0.070    8.903    0.000    0.619    0.570
    x8                0.731    0.066   11.090    0.000    0.731    0.723
    x9                0.670    0.065   10.305    0.000    0.670    0.665

Covariances:
                   Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all
  visual ~~                                                             
    textual           0.459    0.064    7.189    0.000    0.459    0.459
    speed             0.471    0.073    6.461    0.000    0.471    0.471
  textual ~~                                                            
    speed             0.283    0.069    4.117    0.000    0.283    0.283

Variances:
                   Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all
   .x1                0.549    0.114    4.833    0.000    0.549    0.404
   .x2                1.134    0.102   11.146    0.000    1.134    0.821
   .x3                0.844    0.091    9.317    0.000    0.844    0.662
   .x4                0.371    0.048    7.779    0.000    0.371    0.275
   .x5                0.446    0.058    7.642    0.000    0.446    0.269
   .x6                0.356    0.043    8.277    0.000    0.356    0.298
   .x7                0.799    0.081    9.823    0.000    0.799    0.676
   .x8                0.488    0.074    6.573    0.000    0.488    0.477
   .x9                0.566    0.071    8.003    0.000    0.566    0.558
    visual            1.000                               1.000    1.000
    textual           1.000                               1.000    1.000
    speed             1.000                               1.000    1.000</code></pre>
</div>
</div>
<hr>
</section>
</section>
<section id="exercise-1-compare-the-two-models" class="level1">
<h1>Exercise 1 — Compare the two models</h1>
<section id="a-compare-global-fit" class="level2">
<h2 class="anchored" data-anchor-id="a-compare-global-fit">1a) Compare global fit</h2>
<p>Extract a minimal set of indices:</p>
<div class="cell">
<details class="code-fold">
<summary>Show code</summary>
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a>get_fit <span class="ot">&lt;-</span> <span class="cf">function</span>(f) {</span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">fitMeasures</span>(f, <span class="fu">c</span>(<span class="st">"chisq"</span>,<span class="st">"df"</span>,<span class="st">"pvalue"</span>,<span class="st">"cfi"</span>,<span class="st">"tli"</span>,<span class="st">"rmsea"</span>,<span class="st">"rmsea.ci.lower"</span>,<span class="st">"rmsea.ci.upper"</span>,<span class="st">"srmr"</span>))</span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a><span class="fu">rbind</span>(<span class="at">one_factor =</span> <span class="fu">get_fit</span>(fit1),</span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true" tabindex="-1"></a>      <span class="at">three_factor =</span> <span class="fu">get_fit</span>(fit3))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>             chisq df  pvalue   cfi   tli  rmsea rmsea.ci.lower rmsea.ci.upper
one_factor   312.3 27 0.0e+00 0.677 0.569 0.1874         0.1690          0.206
three_factor  85.3 24 8.5e-09 0.931 0.896 0.0921         0.0714          0.114
               srmr
one_factor   0.1431
three_factor 0.0652</code></pre>
</div>
</div>
<p><strong>Questions</strong></p>
<ol type="1">
<li>Which model fits better globally? Which indices support that conclusion?</li>
<li>Do you expect the 3-factor model to always fit better? Why/why not?</li>
</ol>
</section>
<section id="b-compare-with-a-χ²-difference-test-nested" class="level2">
<h2 class="anchored" data-anchor-id="b-compare-with-a-χ²-difference-test-nested">1b) Compare with a χ² difference test (nested?)</h2>
<div class="cell">
<details class="code-fold">
<summary>Show code</summary>
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="fu">anova</span>(fit1, fit3)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
Chi-Squared Difference Test

     Df  AIC  BIC Chisq Chisq diff RMSEA Df diff Pr(&gt;Chisq)    
fit3 24 7517 7595  85.3                                        
fit1 27 7738 7805 312.3        227 0.498       3     &lt;2e-16 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
</div>
<p><strong>Question</strong></p>
<ul>
<li>Is this comparison a valid nested χ² test here? Why (think: is the 1-factor model nested in the 3-factor model)?</li>
</ul>
<div class="callout callout-style-simple callout-note no-icon">
<div class="callout-body d-flex">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-body-container">
<p>Even when <code>anova()</code> runs, you must reason about <em>nesting</em>. Not every model comparison is a proper LRT.</p>
</div>
</div>
</div>
<hr>
</section>
</section>
<section id="part-b-interpret-key-parameters-measurement-level-thinking" class="level1">
<h1>Part B — Interpret key parameters (measurement-level thinking)</h1>
</section>
<section id="exercise-2-loadings-residual-variances-and-factor-correlations" class="level1">
<h1>Exercise 2 — Loadings, residual variances, and factor correlations</h1>
<section id="a-standardized-loadings" class="level2">
<h2 class="anchored" data-anchor-id="a-standardized-loadings">2a) Standardized loadings</h2>
<div class="cell">
<details class="code-fold">
<summary>Show code</summary>
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a>pe3 <span class="ot">&lt;-</span> <span class="fu">parameterEstimates</span>(fit3, <span class="at">standardized =</span> <span class="cn">TRUE</span>)</span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a>load3 <span class="ot">&lt;-</span> <span class="fu">subset</span>(pe3, op <span class="sc">==</span> <span class="st">"=~"</span>)[, <span class="fu">c</span>(<span class="st">"lhs"</span>,<span class="st">"rhs"</span>,<span class="st">"est"</span>,<span class="st">"se"</span>,<span class="st">"pvalue"</span>,<span class="st">"std.all"</span>)]</span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a>load3</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>      lhs rhs   est    se pvalue std.all
1  visual  x1 0.900 0.081      0   0.772
2  visual  x2 0.498 0.077      0   0.424
3  visual  x3 0.656 0.074      0   0.581
4 textual  x4 0.990 0.057      0   0.852
5 textual  x5 1.102 0.063      0   0.855
6 textual  x6 0.917 0.054      0   0.838
7   speed  x7 0.619 0.070      0   0.570
8   speed  x8 0.731 0.066      0   0.723
9   speed  x9 0.670 0.065      0   0.665</code></pre>
</div>
</div>
<p><strong>Tasks</strong></p>
<ol type="1">
<li>Identify the weakest indicator(s) by <code>std.all</code>.</li>
<li>Identify any signs that look strange (e.g., negative loadings, extremely low/high).</li>
</ol>
</section>
<section id="b-residual-variances" class="level2">
<h2 class="anchored" data-anchor-id="b-residual-variances">2b) Residual variances</h2>
<div class="cell">
<details class="code-fold">
<summary>Show code</summary>
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a>resvar3 <span class="ot">&lt;-</span> <span class="fu">subset</span>(pe3, op <span class="sc">==</span> <span class="st">"~~"</span> <span class="sc">&amp;</span> lhs <span class="sc">%in%</span> vars <span class="sc">&amp;</span> rhs <span class="sc">%in%</span> vars)[, <span class="fu">c</span>(<span class="st">"lhs"</span>,<span class="st">"est"</span>,<span class="st">"std.all"</span>)]</span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a>resvar3</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>   lhs   est std.all
10  x1 0.549   0.404
11  x2 1.134   0.821
12  x3 0.844   0.662
13  x4 0.371   0.275
14  x5 0.446   0.269
15  x6 0.356   0.298
16  x7 0.799   0.676
17  x8 0.488   0.477
18  x9 0.566   0.558</code></pre>
</div>
</div>
<p><strong>Question</strong></p>
<ul>
<li>Do any residual variances look “too small” or “too large”? What might that mean substantively?</li>
</ul>
</section>
<section id="c-factor-correlations" class="level2">
<h2 class="anchored" data-anchor-id="c-factor-correlations">2c) Factor correlations</h2>
<div class="cell">
<details class="code-fold">
<summary>Show code</summary>
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a>phi3 <span class="ot">&lt;-</span> <span class="fu">subset</span>(pe3, op <span class="sc">==</span> <span class="st">"~~"</span> <span class="sc">&amp;</span> lhs <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"visual"</span>,<span class="st">"textual"</span>,<span class="st">"speed"</span>) <span class="sc">&amp;</span></span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a>                 rhs <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"visual"</span>,<span class="st">"textual"</span>,<span class="st">"speed"</span>) <span class="sc">&amp;</span> lhs <span class="sc">!=</span> rhs)[, <span class="fu">c</span>(<span class="st">"lhs"</span>,<span class="st">"rhs"</span>,<span class="st">"est"</span>,<span class="st">"std.all"</span>)]</span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a>phi3</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>       lhs     rhs   est std.all
22  visual textual 0.459   0.459
23  visual   speed 0.471   0.471
24 textual   speed 0.283   0.283</code></pre>
</div>
</div>
<p><strong>Questions</strong></p>
<ol type="1">
<li>Are factor correlations high? What would make you worry about discriminant validity?</li>
<li>In your area, what theory would justify correlated factors?</li>
</ol>
<hr>
</section>
</section>
<section id="part-c-local-misfit-residual-correlations-and-mi-cfa-specific" class="level1">
<h1>Part C — Local misfit: residual correlations and MI (CFA-specific)</h1>
<p>Global fit is a summary. Now locate misfit.</p>
</section>
<section id="exercise-3-residual-correlations-where-does-the-model-fail" class="level1">
<h1>Exercise 3 — Residual correlations (where does the model fail?)</h1>
<div class="cell">
<details class="code-fold">
<summary>Show code</summary>
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a>res_std <span class="ot">&lt;-</span> <span class="fu">residuals</span>(fit3, <span class="at">type =</span> <span class="st">"standardized"</span>)<span class="sc">$</span>cov</span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a>res_std</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>       x1     x2     x3     x4     x5     x6     x7     x8     x9
x1  0.000                                                        
x2 -1.996  0.000                                                 
x3 -0.997  2.689  0.000                                          
x4  2.679 -0.284 -1.899  0.000                                   
x5 -0.359 -0.591 -4.157  1.545  0.000                            
x6  2.155  0.681 -0.711 -2.588  0.941  0.000                     
x7 -3.773 -3.654 -1.858  0.865 -0.842 -0.326  0.000              
x8 -1.380 -1.119 -0.300 -2.021 -1.099 -0.641  4.823  0.000       
x9  4.077  1.606  3.518  1.225  1.701  1.423 -2.325 -4.132  0.000</code></pre>
</div>
</div>
<p><strong>Tasks</strong></p>
<ol type="1">
<li>Find the <strong>largest absolute</strong> standardized residual correlations (top 3–5).<br>
(Tip: scan the matrix or use code below.)</li>
</ol>
<div class="cell">
<details class="code-fold">
<summary>Show code</summary>
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="co"># helper: get top absolute residuals (excluding diagonal)</span></span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a>R <span class="ot">&lt;-</span> res_std</span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a><span class="fu">diag</span>(R) <span class="ot">&lt;-</span> <span class="cn">NA</span></span>
<span id="cb20-4"><a href="#cb20-4" aria-hidden="true" tabindex="-1"></a>top <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(<span class="fu">as.table</span>(R))</span>
<span id="cb20-5"><a href="#cb20-5" aria-hidden="true" tabindex="-1"></a>top <span class="ot">&lt;-</span> top[<span class="fu">order</span>(<span class="fu">abs</span>(top<span class="sc">$</span>Freq), <span class="at">decreasing =</span> <span class="cn">TRUE</span>), ]</span>
<span id="cb20-6"><a href="#cb20-6" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(top, <span class="dv">10</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>   Var1 Var2  Freq
62   x8   x7  4.82
70   x7   x8  4.82
23   x5   x3 -4.16
39   x3   x5 -4.16
72   x9   x8 -4.13
80   x8   x9 -4.13
9    x9   x1  4.08
73   x1   x9  4.08
7    x7   x1 -3.77
55   x1   x7 -3.77</code></pre>
</div>
</div>
<ol start="2" type="1">
<li>For each large residual pair, write a <em>measurement-level hypothesis</em>:
<ul>
<li>shared wording/content?</li>
<li>method effect?</li>
<li>plausible cross-loading?</li>
<li>local dependence (same stimulus format, similar items)?</li>
</ul></li>
</ol>
<hr>
</section>
<section id="exercise-4-mi-epcsepc-use-with-a-theory-filter" class="level1">
<h1>Exercise 4 — MI + EPC/SEPC (use with a theory filter)</h1>
<div class="cell">
<details class="code-fold">
<summary>Show code</summary>
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a>mi <span class="ot">&lt;-</span> <span class="fu">modificationIndices</span>(fit3, <span class="at">sort. =</span> <span class="cn">TRUE</span>)</span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(mi[, <span class="fu">c</span>(<span class="st">"lhs"</span>,<span class="st">"op"</span>,<span class="st">"rhs"</span>,<span class="st">"mi"</span>,<span class="st">"epc"</span>,<span class="st">"sepc.all"</span>)], <span class="dv">15</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>       lhs op rhs    mi    epc sepc.all
30  visual =~  x9 36.41  0.519    0.515
76      x7 ~~  x8 34.15  0.536    0.859
28  visual =~  x7 18.63 -0.380   -0.349
78      x8 ~~  x9 14.95 -0.423   -0.805
33 textual =~  x3  9.15 -0.269   -0.238
55      x2 ~~  x7  8.92 -0.183   -0.192
31 textual =~  x1  8.90  0.347    0.297
51      x2 ~~  x3  8.53  0.218    0.223
59      x3 ~~  x5  7.86 -0.130   -0.212
26  visual =~  x5  7.44 -0.189   -0.147
50      x1 ~~  x9  7.33  0.138    0.247
65      x4 ~~  x6  6.22 -0.235   -0.646
66      x4 ~~  x7  5.92  0.098    0.180
48      x1 ~~  x7  5.42 -0.129   -0.195
77      x7 ~~  x9  5.18 -0.187   -0.278</code></pre>
</div>
</div>
<p><strong>Tasks</strong></p>
<ol type="1">
<li>Compare MI results with your largest residual pairs. Do they point to the same area?</li>
<li>Pick <strong>one</strong> candidate modification, but only if you can justify it conceptually.</li>
<li>Decide: is it more plausible as:
<ul>
<li>correlated residual (<code>x_i ~~ x_j</code>) OR</li>
<li>cross-loading (<code>factor =~ x_j</code>)?</li>
</ul></li>
</ol>
<div class="callout callout-style-simple callout-warning no-icon">
<div class="callout-body d-flex">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-body-container">
<p>Correlated residuals are not “free fit”: they change the measurement story (local dependence). Cross-loadings threaten simple structure and interpretation.</p>
</div>
</div>
</div>
<hr>
</section>
<section id="exercise-5-respecify-one-change-refit-document" class="level1">
<h1>Exercise 5 — Respecify (one change), refit, document</h1>
<p>Create <code>m3b</code> by copying <code>m3</code> and adding exactly <strong>one</strong> modification you justified.</p>
<p>Examples:</p>
<ul>
<li>correlated residual: <code>x1 ~~ x2</code></li>
<li>cross-loading: <code>visual =~ x4</code> (be careful: interpretability!)</li>
</ul>
<div class="cell">
<details class="code-fold">
<summary>Show code</summary>
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a>m3b <span class="ot">&lt;-</span> <span class="st">'</span></span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a><span class="st">  visual  =~ x1 + x2 + x3</span></span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a><span class="st">  textual =~ x4 + x5 + x6</span></span>
<span id="cb24-4"><a href="#cb24-4" aria-hidden="true" tabindex="-1"></a><span class="st">  speed   =~ x7 + x8 + x9</span></span>
<span id="cb24-5"><a href="#cb24-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-6"><a href="#cb24-6" aria-hidden="true" tabindex="-1"></a><span class="st">  # ADD ONE THEORY-JUSTIFIED PARAMETER HERE</span></span>
<span id="cb24-7"><a href="#cb24-7" aria-hidden="true" tabindex="-1"></a><span class="st">  # x1 ~~ x2</span></span>
<span id="cb24-8"><a href="#cb24-8" aria-hidden="true" tabindex="-1"></a><span class="st">'</span></span>
<span id="cb24-9"><a href="#cb24-9" aria-hidden="true" tabindex="-1"></a>fit3b <span class="ot">&lt;-</span> <span class="fu">cfa</span>(m3b, <span class="at">data =</span> dat, <span class="at">std.lv =</span> <span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Compare fit:</p>
<div class="cell">
<details class="code-fold">
<summary>Show code</summary>
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a><span class="fu">rbind</span>(<span class="at">original =</span> <span class="fu">get_fit</span>(fit3),</span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a>      <span class="at">modified =</span> <span class="fu">get_fit</span>(fit3b))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>         chisq df  pvalue   cfi   tli  rmsea rmsea.ci.lower rmsea.ci.upper
original  85.3 24 8.5e-09 0.931 0.896 0.0921         0.0714          0.114
modified  85.3 24 8.5e-09 0.931 0.896 0.0921         0.0714          0.114
           srmr
original 0.0652
modified 0.0652</code></pre>
</div>
</div>
<p>Compare nested models (if nested):</p>
<div class="cell">
<details class="code-fold">
<summary>Show code</summary>
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a><span class="fu">anova</span>(fit3, fit3b)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
Chi-Squared Difference Test

      Df  AIC  BIC Chisq Chisq diff RMSEA Df diff Pr(&gt;Chisq)
fit3  24 7517 7595  85.3                                    
fit3b 24 7517 7595  85.3          0     0       0           </code></pre>
</div>
</div>
<p><strong>Documentation (write 3 bullet points)</strong></p>
<ul>
<li>What did you add and why?</li>
<li>What diagnostic evidence supported it (residuals? MI+EPC?)?</li>
<li>Does the modification change the <em>interpretation</em> of the factor(s)?</li>
</ul>
<hr>
</section>
<section id="part-d-reliability-from-cfa-ω-family" class="level1">
<h1>Part D — Reliability from CFA (ω family)</h1>
</section>
<section id="exercise-6-compute-ω-reliability" class="level1">
<h1>Exercise 6 — Compute ω reliability</h1>
<div class="cell">
<details class="code-fold">
<summary>Show code</summary>
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a><span class="fu">reliability</span>(fit3)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>       visual textual speed
alpha   0.626   0.883 0.688
omega   0.625   0.885 0.688
omega2  0.625   0.885 0.688
omega3  0.612   0.885 0.686
avevar  0.371   0.721 0.424</code></pre>
</div>
</div>
<p><strong>Questions</strong></p>
<ol type="1">
<li>Which ω coefficients are reported? What do they mean conceptually?</li>
<li>Compare ω across the three factors. Which factor seems most reliable and why?</li>
</ol>
<hr>
</section>
<section id="optional-part-e-bifactor-model-advanced" class="level1">
<h1>Optional Part E — Bifactor model (advanced)</h1>
<p>This is not required, but if you want to keep the bifactor material “real”, do it once.</p>
<p>A <strong>bifactor</strong> model: a general factor <code>g</code> loads on all items, plus domain-specific factors. Domain factors are often set orthogonal to <code>g</code> (and sometimes mutually orthogonal).</p>
<div class="cell">
<details class="code-fold">
<summary>Show code</summary>
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a>mbi <span class="ot">&lt;-</span> <span class="st">'</span></span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a><span class="st">  # group factors</span></span>
<span id="cb31-3"><a href="#cb31-3" aria-hidden="true" tabindex="-1"></a><span class="st">  visual  =~ x1 + x2 + x3</span></span>
<span id="cb31-4"><a href="#cb31-4" aria-hidden="true" tabindex="-1"></a><span class="st">  textual =~ x4 + x5 + x6</span></span>
<span id="cb31-5"><a href="#cb31-5" aria-hidden="true" tabindex="-1"></a><span class="st">  speed   =~ x7 + x8 + x9</span></span>
<span id="cb31-6"><a href="#cb31-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-7"><a href="#cb31-7" aria-hidden="true" tabindex="-1"></a><span class="st">  # general factor</span></span>
<span id="cb31-8"><a href="#cb31-8" aria-hidden="true" tabindex="-1"></a><span class="st">  g =~ x1 + x2 + x3 + x4 + x5 + x6 + x7 + x8 + x9</span></span>
<span id="cb31-9"><a href="#cb31-9" aria-hidden="true" tabindex="-1"></a><span class="st">'</span></span>
<span id="cb31-10"><a href="#cb31-10" aria-hidden="true" tabindex="-1"></a>fit_bi <span class="ot">&lt;-</span> <span class="fu">cfa</span>(mbi, <span class="at">data =</span> dat, <span class="at">std.lv =</span> <span class="cn">TRUE</span>, <span class="at">orthogonal =</span> <span class="cn">TRUE</span>)</span>
<span id="cb31-11"><a href="#cb31-11" aria-hidden="true" tabindex="-1"></a><span class="fu">get_fit</span>(fit_bi)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>         chisq             df         pvalue            cfi            tli 
        34.880         18.000          0.010          0.981          0.962 
         rmsea rmsea.ci.lower rmsea.ci.upper           srmr 
         0.056          0.027          0.083          0.047 </code></pre>
</div>
</div>
<p><strong>Tasks</strong></p>
<ol type="1">
<li>Does bifactor fit “better”? (It often does.)</li>
<li>Are all factors interpretable? Inspect standardized loadings.</li>
</ol>
<div class="cell">
<details class="code-fold">
<summary>Show code</summary>
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a>pe_bi <span class="ot">&lt;-</span> <span class="fu">parameterEstimates</span>(fit_bi, <span class="at">standardized =</span> <span class="cn">TRUE</span>)</span>
<span id="cb33-2"><a href="#cb33-2" aria-hidden="true" tabindex="-1"></a><span class="fu">subset</span>(pe_bi, op <span class="sc">==</span> <span class="st">"=~"</span>)[, <span class="fu">c</span>(<span class="st">"lhs"</span>,<span class="st">"rhs"</span>,<span class="st">"std.all"</span>)]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>       lhs rhs std.all
1   visual  x1  -0.999
2   visual  x2   0.161
3   visual  x3   0.143
4  textual  x4   0.761
5  textual  x5   0.824
6  textual  x6   0.742
7    speed  x7   0.660
8    speed  x8   0.715
9    speed  x9   0.476
10       g  x1   0.918
11       g  x2   0.499
12       g  x3   0.635
13       g  x4   0.371
14       g  x5   0.287
15       g  x6   0.377
16       g  x7   0.060
17       g  x8   0.247
18       g  x9   0.440</code></pre>
</div>
</div>
<ol start="3" type="1">
<li>Compute reliability indices.</li>
</ol>
<div class="cell">
<details class="code-fold">
<summary>Show code</summary>
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a><span class="fu">reliability</span>(fit_bi)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>       visual textual speed     g
alpha  0.6261   0.883 0.688 0.760
omega  0.5266   0.869 0.686 0.846
omega2 0.0961   0.744 0.620 0.551
omega3 0.0961   0.744 0.620 0.535
avevar     NA      NA    NA    NA</code></pre>
</div>
</div>
<div class="callout callout-style-simple callout-note no-icon">
<div class="callout-body d-flex">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-body-container">
<p>Interpret bifactor with diagnostics (e.g., ωH/ECV/H). Fit alone is not enough. If you want more, see the extras module on bifactor/ESEM/method factors.</p>
</div>
</div>
</div>
<hr>
</section>
<section id="wrap-up" class="level1">
<h1>Wrap-up</h1>
<section id="take-home" class="level2">
<h2 class="anchored" data-anchor-id="take-home">Take-home</h2>
<ul>
<li>CFA is a <em>measurement hypothesis</em>: zeros and constraints are theory.</li>
<li>Pair <strong>global fit</strong> with CFA-specific <strong>local diagnostics</strong> (residual correlations + MI/EPC).</li>
<li>Respecify with discipline: one change at a time, theory filter, transparent reporting.</li>
<li>Reliability should match your measurement model: ω from CFA is usually a better default than α.</li>
</ul>
<hr>
</section>
</section>
<section id="solutions-instructor-version" class="level1">
<h1>Solutions (instructor version)</h1>
<p>#| echo: false if (SHOW) { # Typical modification: correlate residuals within a domain (often x1 ~~ x2 in HS) m3b_sol &lt;- ’ visual =~ x1 + x2 + x3 textual =~ x4 + x5 + x6 speed =~ x7 + x8 + x9 x1 ~~ x2 ’ fit3b_sol &lt;- cfa(m3b_sol, data = dat, std.lv = TRUE)</p>
<p>list( fit1 = get_fit(fit1), fit3 = get_fit(fit3), top_residuals = head(top, 10), top_mi = head(mi[, c(“lhs”,“op”,“rhs”,“mi”,“epc”,“sepc.all”)], 10), fit3b = get_fit(fit3b_sol), lrt = anova(fit3, fit3b_sol), omega3 = reliability(fit3) ) }</p>


</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
  window.document.addEventListener("DOMContentLoaded", function (event) {
    const icon = "";
    const anchorJS = new window.AnchorJS();
    anchorJS.options = {
      placement: 'right',
      icon: icon
    };
    anchorJS.add('.anchored');
    const isCodeAnnotation = (el) => {
      for (const clz of el.classList) {
        if (clz.startsWith('code-annotation-')) {                     
          return true;
        }
      }
      return false;
    }
    const onCopySuccess = function(e) {
      // button target
      const button = e.trigger;
      // don't keep focus
      button.blur();
      // flash "checked"
      button.classList.add('code-copy-button-checked');
      var currentTitle = button.getAttribute("title");
      button.setAttribute("title", "Copied!");
      let tooltip;
      if (window.bootstrap) {
        button.setAttribute("data-bs-toggle", "tooltip");
        button.setAttribute("data-bs-placement", "left");
        button.setAttribute("data-bs-title", "Copied!");
        tooltip = new bootstrap.Tooltip(button, 
          { trigger: "manual", 
            customClass: "code-copy-button-tooltip",
            offset: [0, -8]});
        tooltip.show();    
      }
      setTimeout(function() {
        if (tooltip) {
          tooltip.hide();
          button.removeAttribute("data-bs-title");
          button.removeAttribute("data-bs-toggle");
          button.removeAttribute("data-bs-placement");
        }
        button.setAttribute("title", currentTitle);
        button.classList.remove('code-copy-button-checked');
      }, 1000);
      // clear code selection
      e.clearSelection();
    }
    const getTextToCopy = function(trigger) {
        const codeEl = trigger.previousElementSibling.cloneNode(true);
        for (const childEl of codeEl.children) {
          if (isCodeAnnotation(childEl)) {
            childEl.remove();
          }
        }
        return codeEl.innerText;
    }
    const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
      text: getTextToCopy
    });
    clipboard.on('success', onCopySuccess);
    if (window.document.getElementById('quarto-embedded-source-code-modal')) {
      const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
        text: getTextToCopy,
        container: window.document.getElementById('quarto-embedded-source-code-modal')
      });
      clipboardModal.on('success', onCopySuccess);
    }
      var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var mailtoRegex = new RegExp(/^mailto:/);
        var filterRegex = new RegExp('/' + window.location.host + '/');
      var isInternal = (href) => {
          return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
      }
      // Inspect non-navigation links and adorn them if external
     var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
      for (var i=0; i<links.length; i++) {
        const link = links[i];
        if (!isInternal(link.href)) {
          // undo the damage that might have been done by quarto-nav.js in the case of
          // links that we want to consider external
          if (link.dataset.originalHref !== undefined) {
            link.href = link.dataset.originalHref;
          }
        }
      }
    function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
      const config = {
        allowHTML: true,
        maxWidth: 500,
        delay: 100,
        arrow: false,
        appendTo: function(el) {
            return el.parentElement;
        },
        interactive: true,
        interactiveBorder: 10,
        theme: 'quarto',
        placement: 'bottom-start',
      };
      if (contentFn) {
        config.content = contentFn;
      }
      if (onTriggerFn) {
        config.onTrigger = onTriggerFn;
      }
      if (onUntriggerFn) {
        config.onUntrigger = onUntriggerFn;
      }
      window.tippy(el, config); 
    }
    const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
    for (var i=0; i<noterefs.length; i++) {
      const ref = noterefs[i];
      tippyHover(ref, function() {
        // use id or data attribute instead here
        let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
        try { href = new URL(href).hash; } catch {}
        const id = href.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note) {
          return note.innerHTML;
        } else {
          return "";
        }
      });
    }
    const xrefs = window.document.querySelectorAll('a.quarto-xref');
    const processXRef = (id, note) => {
      // Strip column container classes
      const stripColumnClz = (el) => {
        el.classList.remove("page-full", "page-columns");
        if (el.children) {
          for (const child of el.children) {
            stripColumnClz(child);
          }
        }
      }
      stripColumnClz(note)
      if (id === null || id.startsWith('sec-')) {
        // Special case sections, only their first couple elements
        const container = document.createElement("div");
        if (note.children && note.children.length > 2) {
          container.appendChild(note.children[0].cloneNode(true));
          for (let i = 1; i < note.children.length; i++) {
            const child = note.children[i];
            if (child.tagName === "P" && child.innerText === "") {
              continue;
            } else {
              container.appendChild(child.cloneNode(true));
              break;
            }
          }
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(container);
          }
          return container.innerHTML
        } else {
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(note);
          }
          return note.innerHTML;
        }
      } else {
        // Remove any anchor links if they are present
        const anchorLink = note.querySelector('a.anchorjs-link');
        if (anchorLink) {
          anchorLink.remove();
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        if (note.classList.contains("callout")) {
          return note.outerHTML;
        } else {
          return note.innerHTML;
        }
      }
    }
    for (var i=0; i<xrefs.length; i++) {
      const xref = xrefs[i];
      tippyHover(xref, undefined, function(instance) {
        instance.disable();
        let url = xref.getAttribute('href');
        let hash = undefined; 
        if (url.startsWith('#')) {
          hash = url;
        } else {
          try { hash = new URL(url).hash; } catch {}
        }
        if (hash) {
          const id = hash.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note !== null) {
            try {
              const html = processXRef(id, note.cloneNode(true));
              instance.setContent(html);
            } finally {
              instance.enable();
              instance.show();
            }
          } else {
            // See if we can fetch this
            fetch(url.split('#')[0])
            .then(res => res.text())
            .then(html => {
              const parser = new DOMParser();
              const htmlDoc = parser.parseFromString(html, "text/html");
              const note = htmlDoc.getElementById(id);
              if (note !== null) {
                const html = processXRef(id, note);
                instance.setContent(html);
              } 
            }).finally(() => {
              instance.enable();
              instance.show();
            });
          }
        } else {
          // See if we can fetch a full url (with no hash to target)
          // This is a special case and we should probably do some content thinning / targeting
          fetch(url)
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.querySelector('main.content');
            if (note !== null) {
              // This should only happen for chapter cross references
              // (since there is no id in the URL)
              // remove the first header
              if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
                note.children[0].remove();
              }
              const html = processXRef(null, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      }, function(instance) {
      });
    }
        let selectedAnnoteEl;
        const selectorForAnnotation = ( cell, annotation) => {
          let cellAttr = 'data-code-cell="' + cell + '"';
          let lineAttr = 'data-code-annotation="' +  annotation + '"';
          const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
          return selector;
        }
        const selectCodeLines = (annoteEl) => {
          const doc = window.document;
          const targetCell = annoteEl.getAttribute("data-target-cell");
          const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
          const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
          const lines = annoteSpan.getAttribute("data-code-lines").split(",");
          const lineIds = lines.map((line) => {
            return targetCell + "-" + line;
          })
          let top = null;
          let height = null;
          let parent = null;
          if (lineIds.length > 0) {
              //compute the position of the single el (top and bottom and make a div)
              const el = window.document.getElementById(lineIds[0]);
              top = el.offsetTop;
              height = el.offsetHeight;
              parent = el.parentElement.parentElement;
            if (lineIds.length > 1) {
              const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
              const bottom = lastEl.offsetTop + lastEl.offsetHeight;
              height = bottom - top;
            }
            if (top !== null && height !== null && parent !== null) {
              // cook up a div (if necessary) and position it 
              let div = window.document.getElementById("code-annotation-line-highlight");
              if (div === null) {
                div = window.document.createElement("div");
                div.setAttribute("id", "code-annotation-line-highlight");
                div.style.position = 'absolute';
                parent.appendChild(div);
              }
              div.style.top = top - 2 + "px";
              div.style.height = height + 4 + "px";
              div.style.left = 0;
              let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
              if (gutterDiv === null) {
                gutterDiv = window.document.createElement("div");
                gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
                gutterDiv.style.position = 'absolute';
                const codeCell = window.document.getElementById(targetCell);
                const gutter = codeCell.querySelector('.code-annotation-gutter');
                gutter.appendChild(gutterDiv);
              }
              gutterDiv.style.top = top - 2 + "px";
              gutterDiv.style.height = height + 4 + "px";
            }
            selectedAnnoteEl = annoteEl;
          }
        };
        const unselectCodeLines = () => {
          const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
          elementsIds.forEach((elId) => {
            const div = window.document.getElementById(elId);
            if (div) {
              div.remove();
            }
          });
          selectedAnnoteEl = undefined;
        };
          // Handle positioning of the toggle
      window.addEventListener(
        "resize",
        throttle(() => {
          elRect = undefined;
          if (selectedAnnoteEl) {
            selectCodeLines(selectedAnnoteEl);
          }
        }, 10)
      );
      function throttle(fn, ms) {
      let throttle = false;
      let timer;
        return (...args) => {
          if(!throttle) { // first call gets through
              fn.apply(this, args);
              throttle = true;
          } else { // all the others get throttled
              if(timer) clearTimeout(timer); // cancel #2
              timer = setTimeout(() => {
                fn.apply(this, args);
                timer = throttle = false;
              }, ms);
          }
        };
      }
        // Attach click handler to the DT
        const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
        for (const annoteDlNode of annoteDls) {
          annoteDlNode.addEventListener('click', (event) => {
            const clickedEl = event.target;
            if (clickedEl !== selectedAnnoteEl) {
              unselectCodeLines();
              const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
              if (activeEl) {
                activeEl.classList.remove('code-annotation-active');
              }
              selectCodeLines(clickedEl);
              clickedEl.classList.add('code-annotation-active');
            } else {
              // Unselect the line
              unselectCodeLines();
              clickedEl.classList.remove('code-annotation-active');
            }
          });
        }
    const findCites = (el) => {
      const parentEl = el.parentElement;
      if (parentEl) {
        const cites = parentEl.dataset.cites;
        if (cites) {
          return {
            el,
            cites: cites.split(' ')
          };
        } else {
          return findCites(el.parentElement)
        }
      } else {
        return undefined;
      }
    };
    var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
    for (var i=0; i<bibliorefs.length; i++) {
      const ref = bibliorefs[i];
      const citeInfo = findCites(ref);
      if (citeInfo) {
        tippyHover(citeInfo.el, function() {
          var popup = window.document.createElement('div');
          citeInfo.cites.forEach(function(cite) {
            var citeDiv = window.document.createElement('div');
            citeDiv.classList.add('hanging-indent');
            citeDiv.classList.add('csl-entry');
            var biblioDiv = window.document.getElementById('ref-' + cite);
            if (biblioDiv) {
              citeDiv.innerHTML = biblioDiv.innerHTML;
            }
            popup.appendChild(citeDiv);
          });
          return popup.innerHTML;
        });
      }
    }
  });
  </script>
</div> <!-- /content -->




</body></html>